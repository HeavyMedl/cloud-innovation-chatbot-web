{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar Enums = require(\"./enums\");\n\nvar Utils = require(\"./utils\");\n\nvar HostConfig = require(\"./host-config\");\n\nvar TextFormatters = require(\"./text-formatters\");\n\nfunction invokeSetCollection(action, collection) {\n  if (action) {\n    // Closest emulation of \"internal\" in TypeScript.\n    action[\"setCollection\"](collection);\n  }\n}\n\nfunction isActionAllowed(action, forbiddenActionTypes) {\n  if (forbiddenActionTypes) {\n    for (var i = 0; i < forbiddenActionTypes.length; i++) {\n      if (action.getJsonTypeName() === forbiddenActionTypes[i]) {\n        return false;\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction generateUniqueId() {\n  return \"__ac-\" + Utils.UUID.generate();\n}\n\nfunction createCardObjectInstance(parent, json, createInstanceCallback, createValidationErrorCallback, errors) {\n  var result = null;\n\n  if (json && typeof json === \"object\") {\n    var tryToFallback = false;\n    var typeName = json[\"type\"];\n    result = createInstanceCallback(typeName);\n\n    if (!result) {\n      tryToFallback = true;\n      raiseParseError(createValidationErrorCallback(typeName), errors);\n    } else {\n      result.setParent(parent);\n      result.parse(json);\n      tryToFallback = result.shouldFallback();\n    }\n\n    if (tryToFallback) {\n      var fallback = json[\"fallback\"];\n\n      if (!fallback) {\n        parent.setShouldFallback(true);\n      }\n\n      if (typeof fallback === \"string\" && fallback.toLowerCase() === \"drop\") {\n        result = null;\n      } else if (typeof fallback === \"object\") {\n        result = createCardObjectInstance(parent, fallback, createInstanceCallback, createValidationErrorCallback, errors);\n      }\n    }\n  }\n\n  return result;\n}\n\nfunction createActionInstance(parent, json, errors) {\n  return createCardObjectInstance(parent, json, function (typeName) {\n    return AdaptiveCard.actionTypeRegistry.createInstance(typeName);\n  }, function (typeName) {\n    return {\n      error: Enums.ValidationError.UnknownActionType,\n      message: \"Unknown action type: \" + typeName + \". Attempting to fall back.\"\n    };\n  }, errors);\n}\n\nexports.createActionInstance = createActionInstance;\n\nfunction createElementInstance(parent, json, errors) {\n  return createCardObjectInstance(parent, json, function (typeName) {\n    return AdaptiveCard.elementTypeRegistry.createInstance(typeName);\n  }, function (typeName) {\n    return {\n      error: Enums.ValidationError.UnknownElementType,\n      message: \"Unknown element type: \" + typeName + \". Attempting to fall back.\"\n    };\n  }, errors);\n}\n\nexports.createElementInstance = createElementInstance;\n\nvar SpacingDefinition =\n/** @class */\nfunction () {\n  function SpacingDefinition(top, right, bottom, left) {\n    if (top === void 0) {\n      top = 0;\n    }\n\n    if (right === void 0) {\n      right = 0;\n    }\n\n    if (bottom === void 0) {\n      bottom = 0;\n    }\n\n    if (left === void 0) {\n      left = 0;\n    }\n\n    this.left = 0;\n    this.top = 0;\n    this.right = 0;\n    this.bottom = 0;\n    this.top = top;\n    this.right = right;\n    this.bottom = bottom;\n    this.left = left;\n  }\n\n  return SpacingDefinition;\n}();\n\nexports.SpacingDefinition = SpacingDefinition;\n\nvar PaddingDefinition =\n/** @class */\nfunction () {\n  function PaddingDefinition(top, right, bottom, left) {\n    if (top === void 0) {\n      top = Enums.Spacing.None;\n    }\n\n    if (right === void 0) {\n      right = Enums.Spacing.None;\n    }\n\n    if (bottom === void 0) {\n      bottom = Enums.Spacing.None;\n    }\n\n    if (left === void 0) {\n      left = Enums.Spacing.None;\n    }\n\n    this.top = Enums.Spacing.None;\n    this.right = Enums.Spacing.None;\n    this.bottom = Enums.Spacing.None;\n    this.left = Enums.Spacing.None;\n    this.top = top;\n    this.right = right;\n    this.bottom = bottom;\n    this.left = left;\n  }\n\n  PaddingDefinition.prototype.toSpacingDefinition = function (hostConfig) {\n    return new SpacingDefinition(hostConfig.getEffectiveSpacing(this.top), hostConfig.getEffectiveSpacing(this.right), hostConfig.getEffectiveSpacing(this.bottom), hostConfig.getEffectiveSpacing(this.left));\n  };\n\n  return PaddingDefinition;\n}();\n\nexports.PaddingDefinition = PaddingDefinition;\n\nvar SizeAndUnit =\n/** @class */\nfunction () {\n  function SizeAndUnit(physicalSize, unit) {\n    this.physicalSize = physicalSize;\n    this.unit = unit;\n  }\n\n  SizeAndUnit.parse = function (input) {\n    var result = new SizeAndUnit(0, Enums.SizeUnit.Weight);\n    var regExp = /^([0-9]+)(px|\\*)?$/g;\n    var matches = regExp.exec(input);\n\n    if (matches && matches.length >= 2) {\n      result.physicalSize = parseInt(matches[1]);\n\n      if (matches.length == 3) {\n        if (matches[2] == \"px\") {\n          result.unit = Enums.SizeUnit.Pixel;\n        }\n      }\n\n      return result;\n    }\n\n    throw new Error(\"Invalid size: \" + input);\n  };\n\n  return SizeAndUnit;\n}();\n\nexports.SizeAndUnit = SizeAndUnit;\n\nvar CardElement =\n/** @class */\nfunction () {\n  function CardElement() {\n    this._shouldFallback = false;\n    this._lang = undefined;\n    this._hostConfig = null;\n    this._internalPadding = null;\n    this._parent = null;\n    this._renderedElement = null;\n    this._separatorElement = null;\n    this._isVisible = true;\n    this._truncatedDueToOverflow = false;\n    this._defaultRenderedElementDisplayMode = null;\n    this._padding = null;\n    this.requires = new HostConfig.HostCapabilities();\n    this.horizontalAlignment = null;\n    this.spacing = Enums.Spacing.Default;\n    this.separator = false;\n    this.height = \"auto\";\n    this.customCssSelector = null;\n  }\n\n  CardElement.prototype.internalRenderSeparator = function () {\n    return Utils.renderSeparation({\n      spacing: this.hostConfig.getEffectiveSpacing(this.spacing),\n      lineThickness: this.separator ? this.hostConfig.separator.lineThickness : null,\n      lineColor: this.separator ? this.hostConfig.separator.lineColor : null\n    }, this.separatorOrientation);\n  };\n\n  CardElement.prototype.updateRenderedElementVisibility = function () {\n    if (this._renderedElement) {\n      this._renderedElement.style.display = this._isVisible ? this._defaultRenderedElementDisplayMode : \"none\";\n    }\n\n    if (this._separatorElement) {\n      if (this.parent && this.parent.isFirstElement(this)) {\n        this._separatorElement.style.display = \"none\";\n      } else {\n        this._separatorElement.style.display = this._isVisible ? this._defaultRenderedElementDisplayMode : \"none\";\n      }\n    }\n  };\n\n  CardElement.prototype.hideElementDueToOverflow = function () {\n    if (this._renderedElement && this._isVisible) {\n      this._renderedElement.style.visibility = 'hidden';\n      this._isVisible = false;\n      raiseElementVisibilityChangedEvent(this, false);\n    }\n  };\n\n  CardElement.prototype.showElementHiddenDueToOverflow = function () {\n    if (this._renderedElement && !this._isVisible) {\n      this._renderedElement.style.visibility = null;\n      this._isVisible = true;\n      raiseElementVisibilityChangedEvent(this, false);\n    }\n  }; // Marked private to emulate internal access\n\n\n  CardElement.prototype.handleOverflow = function (maxHeight) {\n    if (this.isVisible || this.isHiddenDueToOverflow()) {\n      var handled = this.truncateOverflow(maxHeight); // Even if we were unable to truncate the element to fit this time,\n      // it still could have been previously truncated\n\n      this._truncatedDueToOverflow = handled || this._truncatedDueToOverflow;\n\n      if (!handled) {\n        this.hideElementDueToOverflow();\n      } else if (handled && !this._isVisible) {\n        this.showElementHiddenDueToOverflow();\n      }\n    }\n  }; // Marked private to emulate internal access\n\n\n  CardElement.prototype.resetOverflow = function () {\n    var sizeChanged = false;\n\n    if (this._truncatedDueToOverflow) {\n      this.undoOverflowTruncation();\n      this._truncatedDueToOverflow = false;\n      sizeChanged = true;\n    }\n\n    if (this.isHiddenDueToOverflow) {\n      this.showElementHiddenDueToOverflow();\n    }\n\n    return sizeChanged;\n  };\n\n  CardElement.prototype.createPlaceholderElement = function () {\n    var element = document.createElement(\"div\");\n    element.style.border = \"1px dashed #DDDDDD\";\n    element.style.padding = \"4px\";\n    element.style.minHeight = \"32px\";\n    element.style.fontSize = \"10px\";\n    element.innerText = \"Empty \" + this.getJsonTypeName();\n    return element;\n  };\n\n  CardElement.prototype.internalGetNonZeroPadding = function (padding, processTop, processRight, processBottom, processLeft) {\n    if (processTop === void 0) {\n      processTop = true;\n    }\n\n    if (processRight === void 0) {\n      processRight = true;\n    }\n\n    if (processBottom === void 0) {\n      processBottom = true;\n    }\n\n    if (processLeft === void 0) {\n      processLeft = true;\n    }\n\n    if (processTop) {\n      if (padding.top == Enums.Spacing.None) {\n        padding.top = this.internalPadding.top;\n      }\n    }\n\n    if (processRight) {\n      if (padding.right == Enums.Spacing.None) {\n        padding.right = this.internalPadding.right;\n      }\n    }\n\n    if (processBottom) {\n      if (padding.bottom == Enums.Spacing.None) {\n        padding.bottom = this.internalPadding.bottom;\n      }\n    }\n\n    if (processLeft) {\n      if (padding.left == Enums.Spacing.None) {\n        padding.left = this.internalPadding.left;\n      }\n    }\n\n    if (this.parent) {\n      this.parent.internalGetNonZeroPadding(padding, processTop && this.isAtTheVeryTop(), processRight && this.isAtTheVeryRight(), processBottom && this.isAtTheVeryBottom(), processLeft && this.isAtTheVeryLeft());\n    }\n  };\n\n  CardElement.prototype.adjustRenderedElementSize = function (renderedElement) {\n    if (this.height === \"auto\") {\n      renderedElement.style.flex = \"0 0 auto\";\n    } else {\n      renderedElement.style.flex = \"1 1 auto\";\n    }\n  };\n  /*\r\n   * Called when this element overflows the bottom of the card.\r\n   * maxHeight will be the amount of space still available on the card (0 if\r\n   * the element is fully off the card).\r\n   */\n\n\n  CardElement.prototype.truncateOverflow = function (maxHeight) {\n    // Child implementations should return true if the element handled\n    // the truncation request such that its content fits within maxHeight,\n    // false if the element should fall back to being hidden\n    return false;\n  };\n  /*\r\n   * This should reverse any changes performed in truncateOverflow().\r\n   */\n\n\n  CardElement.prototype.undoOverflowTruncation = function () {};\n\n  CardElement.prototype.isDesignMode = function () {\n    var rootElement = this.getRootElement();\n    return rootElement instanceof AdaptiveCard && rootElement.designMode;\n  };\n\n  Object.defineProperty(CardElement.prototype, \"useDefaultSizing\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"allowCustomPadding\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"defaultPadding\", {\n    get: function () {\n      return new PaddingDefinition();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"internalPadding\", {\n    get: function () {\n      if (this._padding) {\n        return this._padding;\n      } else {\n        return this._internalPadding && this.allowCustomPadding ? this._internalPadding : this.defaultPadding;\n      }\n    },\n    set: function (value) {\n      this._internalPadding = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"separatorOrientation\", {\n    get: function () {\n      return Enums.Orientation.Horizontal;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  CardElement.prototype.getPadding = function () {\n    return this._padding;\n  };\n\n  CardElement.prototype.setPadding = function (value) {\n    this._padding = value;\n\n    if (this._padding) {\n      AdaptiveCard.useAutomaticContainerBleeding = false;\n    }\n  };\n\n  CardElement.prototype.toJSON = function () {\n    var result = {};\n    Utils.setProperty(result, \"type\", this.getJsonTypeName());\n    Utils.setProperty(result, \"id\", this.id);\n\n    if (this.horizontalAlignment !== null) {\n      Utils.setEnumProperty(Enums.HorizontalAlignment, result, \"horizontalAlignment\", this.horizontalAlignment);\n    }\n\n    Utils.setEnumProperty(Enums.Spacing, result, \"spacing\", this.spacing, Enums.Spacing.Default);\n    Utils.setProperty(result, \"separator\", this.separator, false);\n    Utils.setProperty(result, \"height\", this.height, \"auto\");\n    return result;\n  };\n\n  CardElement.prototype.setParent = function (value) {\n    this._parent = value;\n  };\n\n  CardElement.prototype.getNonZeroPadding = function () {\n    var padding = new PaddingDefinition();\n    this.internalGetNonZeroPadding(padding);\n    return padding;\n  };\n\n  CardElement.prototype.getForbiddenElementTypes = function () {\n    return null;\n  };\n\n  CardElement.prototype.getForbiddenActionTypes = function () {\n    return null;\n  };\n\n  CardElement.prototype.parse = function (json, errors) {\n    raiseParseElementEvent(this, json, errors);\n    this.requires.parse(json[\"requires\"], errors);\n    this.id = json[\"id\"];\n    this.speak = json[\"speak\"];\n    this.horizontalAlignment = Utils.getEnumValueOrDefault(Enums.HorizontalAlignment, json[\"horizontalAlignment\"], null);\n    this.spacing = Utils.getEnumValueOrDefault(Enums.Spacing, json[\"spacing\"], Enums.Spacing.Default);\n    this.separator = json[\"separator\"];\n    var jsonSeparation = json[\"separation\"];\n\n    if (jsonSeparation !== undefined) {\n      if (jsonSeparation === \"none\") {\n        this.spacing = Enums.Spacing.None;\n        this.separator = false;\n      } else if (jsonSeparation === \"strong\") {\n        this.spacing = Enums.Spacing.Large;\n        this.separator = true;\n      } else if (jsonSeparation === \"default\") {\n        this.spacing = Enums.Spacing.Default;\n        this.separator = false;\n      }\n\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The \\\"separation\\\" property is deprecated and will be removed. Use the \\\"spacing\\\" and \\\"separator\\\" properties instead.\"\n      }, errors);\n    }\n\n    var jsonHeight = json[\"height\"];\n\n    if (jsonHeight === \"auto\" || jsonHeight === \"stretch\") {\n      this.height = jsonHeight;\n    }\n  };\n\n  CardElement.prototype.getActionCount = function () {\n    return 0;\n  };\n\n  CardElement.prototype.getActionAt = function (index) {\n    throw new Error(\"Index out of range.\");\n  };\n\n  CardElement.prototype.validate = function () {\n    return [];\n  };\n\n  CardElement.prototype.remove = function () {\n    if (this.parent && this.parent instanceof CardElementContainer) {\n      return this.parent.removeItem(this);\n    }\n\n    return false;\n  };\n\n  CardElement.prototype.render = function () {\n    this._renderedElement = this.internalRender();\n    this._separatorElement = this.internalRenderSeparator();\n\n    if (this._renderedElement) {\n      if (this.customCssSelector) {\n        this._renderedElement.classList.add(this.customCssSelector);\n      }\n\n      this._renderedElement.style.boxSizing = \"border-box\";\n      this._defaultRenderedElementDisplayMode = this._renderedElement.style.display;\n      this.adjustRenderedElementSize(this._renderedElement);\n      this.updateLayout(false);\n    } else if (this.isDesignMode()) {\n      this._renderedElement = this.createPlaceholderElement();\n    }\n\n    return this._renderedElement;\n  };\n\n  CardElement.prototype.updateLayout = function (processChildren) {\n    if (processChildren === void 0) {\n      processChildren = true;\n    }\n\n    this.updateRenderedElementVisibility();\n  };\n\n  CardElement.prototype.indexOf = function (cardElement) {\n    return -1;\n  };\n\n  CardElement.prototype.isRendered = function () {\n    return this._renderedElement && this._renderedElement.offsetHeight > 0;\n  };\n\n  CardElement.prototype.isAtTheVeryTop = function () {\n    return this.parent ? this.parent.isFirstElement(this) && this.parent.isAtTheVeryTop() : true;\n  };\n\n  CardElement.prototype.isFirstElement = function (element) {\n    return true;\n  };\n\n  CardElement.prototype.isAtTheVeryBottom = function () {\n    return this.parent ? this.parent.isLastElement(this) && this.parent.isAtTheVeryBottom() : true;\n  };\n\n  CardElement.prototype.isLastElement = function (element) {\n    return true;\n  };\n\n  CardElement.prototype.isAtTheVeryLeft = function () {\n    return this.parent ? this.parent.isLeftMostElement(this) && this.parent.isAtTheVeryLeft() : true;\n  };\n\n  CardElement.prototype.isBleeding = function () {\n    return false;\n  };\n\n  CardElement.prototype.isLeftMostElement = function (element) {\n    return true;\n  };\n\n  CardElement.prototype.isAtTheVeryRight = function () {\n    return this.parent ? this.parent.isRightMostElement(this) && this.parent.isAtTheVeryRight() : true;\n  };\n\n  CardElement.prototype.isRightMostElement = function (element) {\n    return true;\n  };\n\n  CardElement.prototype.isHiddenDueToOverflow = function () {\n    return this._renderedElement && this._renderedElement.style.visibility == 'hidden';\n  };\n\n  CardElement.prototype.canContentBleed = function () {\n    return this.parent ? this.parent.canContentBleed() : true;\n  };\n\n  CardElement.prototype.getRootElement = function () {\n    var rootElement = this;\n\n    while (rootElement.parent) {\n      rootElement = rootElement.parent;\n    }\n\n    return rootElement;\n  };\n\n  CardElement.prototype.getParentContainer = function () {\n    var currentElement = this.parent;\n\n    while (currentElement) {\n      if (currentElement instanceof Container) {\n        return currentElement;\n      }\n\n      currentElement = currentElement.parent;\n    }\n\n    return null;\n  };\n\n  CardElement.prototype.getAllInputs = function () {\n    return [];\n  };\n\n  CardElement.prototype.getResourceInformation = function () {\n    return [];\n  };\n\n  CardElement.prototype.getElementById = function (id) {\n    return this.id === id ? this : null;\n  };\n\n  CardElement.prototype.getActionById = function (id) {\n    return null;\n  };\n\n  CardElement.prototype.shouldFallback = function () {\n    return this._shouldFallback || !this.requires.areAllMet(this.hostConfig.hostCapabilities);\n  };\n\n  CardElement.prototype.setShouldFallback = function (value) {\n    this._shouldFallback = value;\n  };\n\n  Object.defineProperty(CardElement.prototype, \"lang\", {\n    get: function () {\n      if (this._lang) {\n        return this._lang;\n      } else {\n        if (this.parent) {\n          return this.parent.lang;\n        } else {\n          return undefined;\n        }\n      }\n    },\n    set: function (value) {\n      if (value && value != \"\") {\n        var regEx = /^[a-z]{2,3}$/ig;\n        var matches = regEx.exec(value);\n\n        if (!matches) {\n          throw new Error(\"Invalid language identifier: \" + value);\n        }\n      }\n\n      this._lang = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"hostConfig\", {\n    get: function () {\n      if (this._hostConfig) {\n        return this._hostConfig;\n      } else {\n        if (this.parent) {\n          return this.parent.hostConfig;\n        } else {\n          return defaultHostConfig;\n        }\n      }\n    },\n    set: function (value) {\n      this._hostConfig = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"index\", {\n    get: function () {\n      if (this.parent) {\n        return this.parent.indexOf(this);\n      } else {\n        return 0;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"isInteractive\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"isStandalone\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"parent\", {\n    get: function () {\n      return this._parent;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"isVisible\", {\n    get: function () {\n      return this._isVisible;\n    },\n    set: function (value) {\n      // If the element is going to be hidden, reset any changes that were due\n      // to overflow truncation (this ensures that if the element is later\n      // un-hidden it has the right content)\n      if (AdaptiveCard.useAdvancedCardBottomTruncation && !value) {\n        this.undoOverflowTruncation();\n      }\n\n      if (this._isVisible != value) {\n        this._isVisible = value;\n        this.updateRenderedElementVisibility();\n\n        if (this._renderedElement) {\n          raiseElementVisibilityChangedEvent(this);\n        }\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"hasVisibleSeparator\", {\n    get: function () {\n      var parentContainer = this.getParentContainer();\n\n      if (parentContainer) {\n        return this.separatorElement && !parentContainer.isFirstElement(this);\n      } else {\n        return false;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"renderedElement\", {\n    get: function () {\n      return this._renderedElement;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(CardElement.prototype, \"separatorElement\", {\n    get: function () {\n      return this._separatorElement;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return CardElement;\n}();\n\nexports.CardElement = CardElement;\n\nvar CardElementContainer =\n/** @class */\nfunction (_super) {\n  __extends(CardElementContainer, _super);\n\n  function CardElementContainer() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return CardElementContainer;\n}(CardElement);\n\nexports.CardElementContainer = CardElementContainer;\n\nvar TextBlock =\n/** @class */\nfunction (_super) {\n  __extends(TextBlock, _super);\n\n  function TextBlock() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._processedText = null;\n    _this._treatAsPlainText = true;\n    _this._selectAction = null;\n    _this._effectiveStyleDefinition = null;\n    _this.size = Enums.TextSize.Default;\n    _this.weight = Enums.TextWeight.Default;\n    _this.color = Enums.TextColor.Default;\n    _this.isSubtle = false;\n    _this.wrap = false;\n    _this.useMarkdown = true;\n    return _this;\n  }\n\n  TextBlock.prototype.restoreOriginalContent = function () {\n    var maxHeight = this.maxLines ? this._computedLineHeight * this.maxLines + 'px' : null;\n    this.renderedElement.style.maxHeight = maxHeight;\n    this.renderedElement.innerHTML = this._originalInnerHtml;\n  };\n\n  TextBlock.prototype.truncateIfSupported = function (maxHeight) {\n    // For now, only truncate TextBlocks that contain just a single\n    // paragraph -- since the maxLines calculation doesn't take into\n    // account Markdown lists\n    var children = this.renderedElement.children;\n    var isTextOnly = !children.length;\n    var truncationSupported = isTextOnly || children.length == 1 && children[0].tagName.toLowerCase() == 'p';\n\n    if (truncationSupported) {\n      var element = isTextOnly ? this.renderedElement : children[0];\n      Utils.truncate(element, maxHeight, this._computedLineHeight);\n      return true;\n    }\n\n    return false;\n  };\n\n  TextBlock.prototype.getEffectiveStyleDefinition = function () {\n    if (!this._effectiveStyleDefinition) {\n      this._effectiveStyleDefinition = this.hostConfig.containerStyles.default;\n      var parentContainer = this.getParentContainer();\n\n      while (parentContainer) {\n        if (parentContainer.style) {\n          this._effectiveStyleDefinition = this.hostConfig.containerStyles.getStyleByName(parentContainer.style);\n          break;\n        }\n\n        parentContainer = parentContainer.getParentContainer();\n      }\n    }\n\n    return this._effectiveStyleDefinition;\n  };\n\n  TextBlock.prototype.getRenderedDomElementType = function () {\n    return \"div\";\n  };\n\n  TextBlock.prototype.internalRender = function () {\n    var _this = this;\n\n    this._effectiveStyleDefinition = null;\n    this._processedText = null;\n\n    if (!Utils.isNullOrEmpty(this.text)) {\n      var hostConfig = this.hostConfig;\n      var element = document.createElement(this.getRenderedDomElementType());\n      element.classList.add(hostConfig.makeCssClassName(\"ac-textBlock\"));\n      element.style.overflow = \"hidden\";\n      this.applyStylesTo(element);\n\n      if (this.selectAction) {\n        element.onclick = function (e) {\n          _this.selectAction.execute();\n\n          e.cancelBubble = true;\n        };\n      }\n\n      if (!this._processedText) {\n        this._treatAsPlainText = true;\n        var formattedText = TextFormatters.formatText(this.lang, this.text);\n\n        if (this.useMarkdown) {\n          if (AdaptiveCard.allowMarkForTextHighlighting) {\n            formattedText = formattedText.replace(/<mark>/g, \"===\").replace(/<\\/mark>/g, \"/==\");\n          }\n\n          var markdownProcessingResult = AdaptiveCard.applyMarkdown(formattedText);\n\n          if (markdownProcessingResult.didProcess && markdownProcessingResult.outputHtml) {\n            this._processedText = markdownProcessingResult.outputHtml;\n            this._treatAsPlainText = false; // Only process <mark> tag if markdown processing was applied because\n            // markdown processing is also responsible for sanitizing the input string\n\n            if (AdaptiveCard.allowMarkForTextHighlighting) {\n              var markStyle = \"\";\n              var effectiveStyle = this.getEffectiveStyleDefinition();\n\n              if (effectiveStyle.highlightBackgroundColor) {\n                markStyle += \"background-color: \" + effectiveStyle.highlightBackgroundColor + \";\";\n              }\n\n              if (effectiveStyle.highlightForegroundColor) {\n                markStyle += \"color: \" + effectiveStyle.highlightForegroundColor + \";\";\n              }\n\n              if (!Utils.isNullOrEmpty(markStyle)) {\n                markStyle = 'style=\"' + markStyle + '\"';\n              }\n\n              this._processedText = this._processedText.replace(/===/g, \"<mark \" + markStyle + \">\").replace(/\\/==/g, \"</mark>\");\n            }\n          } else {\n            this._processedText = formattedText;\n            this._treatAsPlainText = true;\n          }\n        } else {\n          this._processedText = formattedText;\n          this._treatAsPlainText = true;\n        }\n      }\n\n      if (this._treatAsPlainText) {\n        element.innerText = this._processedText;\n      } else {\n        element.innerHTML = this._processedText;\n      }\n\n      if (element.firstElementChild instanceof HTMLElement) {\n        var firstElementChild = element.firstElementChild;\n        firstElementChild.style.marginTop = \"0px\";\n        firstElementChild.style.width = \"100%\";\n\n        if (!this.wrap) {\n          firstElementChild.style.overflow = \"hidden\";\n          firstElementChild.style.textOverflow = \"ellipsis\";\n        }\n      }\n\n      if (element.lastElementChild instanceof HTMLElement) {\n        element.lastElementChild.style.marginBottom = \"0px\";\n      }\n\n      var anchors = element.getElementsByTagName(\"a\");\n\n      for (var i = 0; i < anchors.length; i++) {\n        var anchor = anchors[i];\n        anchor.classList.add(this.hostConfig.makeCssClassName(\"ac-anchor\"));\n        anchor.target = \"_blank\";\n\n        anchor.onclick = function (e) {\n          if (raiseAnchorClickedEvent(_this, e.target)) {\n            e.preventDefault();\n          }\n        };\n      }\n\n      if (this.wrap) {\n        element.style.wordWrap = \"break-word\";\n\n        if (this.maxLines > 0) {\n          element.style.maxHeight = this._computedLineHeight * this.maxLines + \"px\";\n          element.style.overflow = \"hidden\";\n        }\n      } else {\n        element.style.whiteSpace = \"nowrap\";\n        element.style.textOverflow = \"ellipsis\";\n      }\n\n      if (AdaptiveCard.useAdvancedTextBlockTruncation || AdaptiveCard.useAdvancedCardBottomTruncation) {\n        this._originalInnerHtml = element.innerHTML;\n      }\n\n      if (this.selectAction != null && hostConfig.supportsInteractivity) {\n        element.tabIndex = 0;\n        element.setAttribute(\"role\", \"button\");\n        element.setAttribute(\"aria-label\", this.selectAction.title);\n        element.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\n      }\n\n      return element;\n    } else {\n      return null;\n    }\n  };\n\n  TextBlock.prototype.truncateOverflow = function (maxHeight) {\n    if (maxHeight >= this._computedLineHeight) {\n      return this.truncateIfSupported(maxHeight);\n    }\n\n    return false;\n  };\n\n  TextBlock.prototype.undoOverflowTruncation = function () {\n    this.restoreOriginalContent();\n\n    if (AdaptiveCard.useAdvancedTextBlockTruncation && this.maxLines) {\n      var maxHeight = this._computedLineHeight * this.maxLines;\n      this.truncateIfSupported(maxHeight);\n    }\n  };\n\n  TextBlock.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setEnumProperty(Enums.TextSize, result, \"size\", this.size, Enums.TextSize.Default);\n    Utils.setEnumProperty(Enums.TextWeight, result, \"weight\", this.weight, Enums.TextWeight.Default);\n    Utils.setEnumProperty(Enums.TextColor, result, \"color\", this.color, Enums.TextColor.Default);\n    Utils.setProperty(result, \"text\", this.text);\n    Utils.setProperty(result, \"isSubtle\", this.isSubtle, false);\n    Utils.setProperty(result, \"wrap\", this.wrap, false);\n    Utils.setProperty(result, \"maxLines\", this.maxLines, 0);\n    return result;\n  };\n\n  TextBlock.prototype.applyStylesTo = function (targetElement) {\n    if (this.hostConfig.fontFamily) {\n      targetElement.style.fontFamily = this.hostConfig.fontFamily;\n    }\n\n    var parentContainer = this.getParentContainer();\n    var isRtl = parentContainer ? parentContainer.isRtl() : false;\n\n    switch (this.horizontalAlignment) {\n      case Enums.HorizontalAlignment.Center:\n        targetElement.style.textAlign = \"center\";\n        break;\n\n      case Enums.HorizontalAlignment.Right:\n        targetElement.style.textAlign = isRtl ? \"left\" : \"right\";\n        break;\n\n      default:\n        targetElement.style.textAlign = isRtl ? \"right\" : \"left\";\n        break;\n    }\n\n    var fontSize;\n\n    switch (this.size) {\n      case Enums.TextSize.Small:\n        fontSize = this.hostConfig.fontSizes.small;\n        break;\n\n      case Enums.TextSize.Medium:\n        fontSize = this.hostConfig.fontSizes.medium;\n        break;\n\n      case Enums.TextSize.Large:\n        fontSize = this.hostConfig.fontSizes.large;\n        break;\n\n      case Enums.TextSize.ExtraLarge:\n        fontSize = this.hostConfig.fontSizes.extraLarge;\n        break;\n\n      default:\n        fontSize = this.hostConfig.fontSizes.default;\n        break;\n    }\n\n    if (this.hostConfig.lineHeights) {\n      switch (this.size) {\n        case Enums.TextSize.Small:\n          this._computedLineHeight = this.hostConfig.lineHeights.small;\n          break;\n\n        case Enums.TextSize.Medium:\n          this._computedLineHeight = this.hostConfig.lineHeights.medium;\n          break;\n\n        case Enums.TextSize.Large:\n          this._computedLineHeight = this.hostConfig.lineHeights.large;\n          break;\n\n        case Enums.TextSize.ExtraLarge:\n          this._computedLineHeight = this.hostConfig.lineHeights.extraLarge;\n          break;\n\n        default:\n          this._computedLineHeight = this.hostConfig.lineHeights.default;\n          break;\n      }\n    } else {\n      // Looks like 1.33 is the magic number to compute line-height\n      // from font size.\n      this._computedLineHeight = fontSize * 1.33;\n    }\n\n    targetElement.style.fontSize = fontSize + \"px\";\n    targetElement.style.lineHeight = this._computedLineHeight + \"px\";\n    var styleDefinition = this.getEffectiveStyleDefinition();\n    var actualTextColor = this.color ? this.color : Enums.TextColor.Default;\n    var colorDefinition;\n\n    switch (actualTextColor) {\n      case Enums.TextColor.Accent:\n        colorDefinition = styleDefinition.foregroundColors.accent;\n        break;\n\n      case Enums.TextColor.Dark:\n        colorDefinition = styleDefinition.foregroundColors.dark;\n        break;\n\n      case Enums.TextColor.Light:\n        colorDefinition = styleDefinition.foregroundColors.light;\n        break;\n\n      case Enums.TextColor.Good:\n        colorDefinition = styleDefinition.foregroundColors.good;\n        break;\n\n      case Enums.TextColor.Warning:\n        colorDefinition = styleDefinition.foregroundColors.warning;\n        break;\n\n      case Enums.TextColor.Attention:\n        colorDefinition = styleDefinition.foregroundColors.attention;\n        break;\n\n      default:\n        colorDefinition = styleDefinition.foregroundColors.default;\n        break;\n    }\n\n    targetElement.style.color = Utils.stringToCssColor(this.isSubtle ? colorDefinition.subtle : colorDefinition.default);\n    var fontWeight;\n\n    switch (this.weight) {\n      case Enums.TextWeight.Lighter:\n        fontWeight = this.hostConfig.fontWeights.lighter;\n        break;\n\n      case Enums.TextWeight.Bolder:\n        fontWeight = this.hostConfig.fontWeights.bolder;\n        break;\n\n      default:\n        fontWeight = this.hostConfig.fontWeights.default;\n        break;\n    }\n\n    targetElement.style.fontWeight = fontWeight.toString();\n  };\n\n  TextBlock.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.text = json[\"text\"];\n    var sizeString = json[\"size\"];\n\n    if (sizeString && typeof sizeString === \"string\" && sizeString.toLowerCase() === \"normal\") {\n      this.size = Enums.TextSize.Default;\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The TextBlock.size value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\n      }, errors);\n    } else {\n      this.size = Utils.getEnumValueOrDefault(Enums.TextSize, sizeString, this.size);\n    }\n\n    var weightString = json[\"weight\"];\n\n    if (weightString && typeof weightString === \"string\" && weightString.toLowerCase() === \"normal\") {\n      this.weight = Enums.TextWeight.Default;\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The TextBlock.weight value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\n      }, errors);\n    } else {\n      this.weight = Utils.getEnumValueOrDefault(Enums.TextWeight, weightString, this.weight);\n    }\n\n    this.color = Utils.getEnumValueOrDefault(Enums.TextColor, json[\"color\"], this.color);\n    this.isSubtle = json[\"isSubtle\"];\n    this.wrap = json[\"wrap\"] === undefined ? false : json[\"wrap\"];\n\n    if (typeof json[\"maxLines\"] === \"number\") {\n      this.maxLines = json[\"maxLines\"];\n    }\n  };\n\n  TextBlock.prototype.getJsonTypeName = function () {\n    return \"TextBlock\";\n  };\n\n  TextBlock.prototype.renderSpeech = function () {\n    if (this.speak != null) return this.speak + '\\n';\n    if (this.text) return '<s>' + this.text + '</s>\\n';\n    return null;\n  };\n\n  TextBlock.prototype.updateLayout = function (processChildren) {\n    if (processChildren === void 0) {\n      processChildren = false;\n    }\n\n    _super.prototype.updateLayout.call(this, processChildren);\n\n    if (AdaptiveCard.useAdvancedTextBlockTruncation && this.maxLines && this.isRendered()) {\n      // Reset the element's innerHTML in case the available room for\n      // content has increased\n      this.restoreOriginalContent();\n      var maxHeight = this._computedLineHeight * this.maxLines;\n      this.truncateIfSupported(maxHeight);\n    }\n  };\n\n  Object.defineProperty(TextBlock.prototype, \"text\", {\n    get: function () {\n      return this._text;\n    },\n    set: function (value) {\n      if (this._text != value) {\n        this._text = value;\n        this._processedText = null;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(TextBlock.prototype, \"selectAction\", {\n    get: function () {\n      return this._selectAction;\n    },\n    set: function (value) {\n      this._selectAction = value;\n\n      if (this._selectAction) {\n        this._selectAction.setParent(this);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return TextBlock;\n}(CardElement);\n\nexports.TextBlock = TextBlock;\n\nvar Label =\n/** @class */\nfunction (_super) {\n  __extends(Label, _super);\n\n  function Label() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Label.prototype.getRenderedDomElementType = function () {\n    return \"label\";\n  };\n\n  Label.prototype.internalRender = function () {\n    var renderedElement = _super.prototype.internalRender.call(this);\n\n    if (!Utils.isNullOrEmpty(this.forElementId)) {\n      renderedElement.htmlFor = this.forElementId;\n    }\n\n    return renderedElement;\n  };\n\n  return Label;\n}(TextBlock);\n\nvar Fact =\n/** @class */\nfunction () {\n  function Fact(name, value) {\n    if (name === void 0) {\n      name = undefined;\n    }\n\n    if (value === void 0) {\n      value = undefined;\n    }\n\n    this.name = name;\n    this.value = value;\n  }\n\n  Fact.prototype.toJSON = function () {\n    return {\n      title: this.name,\n      value: this.value\n    };\n  };\n\n  Fact.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak + '\\n';\n    }\n\n    return '<s>' + this.name + ' ' + this.value + '</s>\\n';\n  };\n\n  return Fact;\n}();\n\nexports.Fact = Fact;\n\nvar FactSet =\n/** @class */\nfunction (_super) {\n  __extends(FactSet, _super);\n\n  function FactSet() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.facts = [];\n    return _this;\n  }\n\n  Object.defineProperty(FactSet.prototype, \"useDefaultSizing\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  FactSet.prototype.internalRender = function () {\n    var element = null;\n    var hostConfig = this.hostConfig;\n\n    if (this.facts.length > 0) {\n      element = document.createElement(\"table\");\n      element.style.borderWidth = \"0px\";\n      element.style.borderSpacing = \"0px\";\n      element.style.borderStyle = \"none\";\n      element.style.borderCollapse = \"collapse\";\n      element.style.display = \"block\";\n      element.style.overflow = \"hidden\";\n      element.classList.add(hostConfig.makeCssClassName(\"ac-factset\"));\n\n      for (var i = 0; i < this.facts.length; i++) {\n        var trElement = document.createElement(\"tr\");\n\n        if (i > 0) {\n          trElement.style.marginTop = this.hostConfig.factSet.spacing + \"px\";\n        } // Title column\n\n\n        var tdElement = document.createElement(\"td\");\n        tdElement.style.padding = \"0\";\n        tdElement.classList.add(hostConfig.makeCssClassName(\"ac-fact-title\"));\n\n        if (this.hostConfig.factSet.title.maxWidth) {\n          tdElement.style.maxWidth = this.hostConfig.factSet.title.maxWidth + \"px\";\n        }\n\n        tdElement.style.verticalAlign = \"top\";\n        var textBlock = new TextBlock();\n        textBlock.setParent(this);\n        textBlock.text = Utils.isNullOrEmpty(this.facts[i].name) ? \"Title\" : this.facts[i].name;\n        textBlock.size = this.hostConfig.factSet.title.size;\n        textBlock.color = this.hostConfig.factSet.title.color;\n        textBlock.isSubtle = this.hostConfig.factSet.title.isSubtle;\n        textBlock.weight = this.hostConfig.factSet.title.weight;\n        textBlock.wrap = this.hostConfig.factSet.title.wrap;\n        textBlock.spacing = Enums.Spacing.None;\n        Utils.appendChild(tdElement, textBlock.render());\n        Utils.appendChild(trElement, tdElement); // Spacer column\n\n        tdElement = document.createElement(\"td\");\n        tdElement.style.width = \"10px\";\n        Utils.appendChild(trElement, tdElement); // Value column\n\n        tdElement = document.createElement(\"td\");\n        tdElement.style.verticalAlign = \"top\";\n        tdElement.classList.add(hostConfig.makeCssClassName(\"ac-fact-value\"));\n        textBlock = new TextBlock();\n        textBlock.setParent(this);\n        textBlock.text = Utils.isNullOrEmpty(this.facts[i].value) ? \"Value\" : this.facts[i].value;\n        textBlock.size = this.hostConfig.factSet.value.size;\n        textBlock.color = this.hostConfig.factSet.value.color;\n        textBlock.isSubtle = this.hostConfig.factSet.value.isSubtle;\n        textBlock.weight = this.hostConfig.factSet.value.weight;\n        textBlock.wrap = this.hostConfig.factSet.value.wrap;\n        textBlock.spacing = Enums.Spacing.None;\n        Utils.appendChild(tdElement, textBlock.render());\n        Utils.appendChild(trElement, tdElement);\n        Utils.appendChild(element, trElement);\n      }\n    }\n\n    return element;\n  };\n\n  FactSet.prototype.getJsonTypeName = function () {\n    return \"FactSet\";\n  };\n\n  FactSet.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    var facts = [];\n\n    for (var _i = 0, _a = this.facts; _i < _a.length; _i++) {\n      var fact = _a[_i];\n      facts.push(fact.toJSON());\n    }\n\n    Utils.setProperty(result, \"facts\", facts);\n    return result;\n  };\n\n  FactSet.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.facts = [];\n\n    if (json[\"facts\"] != null) {\n      var jsonFacts = json[\"facts\"];\n      this.facts = [];\n\n      for (var i = 0; i < jsonFacts.length; i++) {\n        var fact = new Fact();\n        fact.name = jsonFacts[i][\"title\"];\n        fact.value = jsonFacts[i][\"value\"];\n        fact.speak = jsonFacts[i][\"speak\"];\n        this.facts.push(fact);\n      }\n    }\n  };\n\n  FactSet.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak + '\\n';\n    } // render each fact\n\n\n    var speak = null;\n\n    if (this.facts.length > 0) {\n      speak = '';\n\n      for (var i = 0; i < this.facts.length; i++) {\n        var speech = this.facts[i].renderSpeech();\n\n        if (speech) {\n          speak += speech;\n        }\n      }\n    }\n\n    return '<p>' + speak + '\\n</p>\\n';\n  };\n\n  return FactSet;\n}(CardElement);\n\nexports.FactSet = FactSet;\n\nvar Image =\n/** @class */\nfunction (_super) {\n  __extends(Image, _super);\n\n  function Image() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.style = Enums.ImageStyle.Default;\n    _this.size = Enums.Size.Auto;\n    _this.pixelWidth = null;\n    _this.pixelHeight = null;\n    _this.altText = \"\";\n    return _this;\n  }\n\n  Image.prototype.parseDimension = function (name, value, errors) {\n    if (value) {\n      if (typeof value === \"string\") {\n        try {\n          var size = Utils.SizeAndUnit.parse(value);\n\n          if (size.unit == Enums.SizeUnit.Pixel) {\n            return size.physicalSize;\n          }\n        } catch (_a) {// Ignore error\n        }\n      }\n\n      raiseParseError({\n        error: Enums.ValidationError.InvalidPropertyValue,\n        message: \"Invalid image \" + name + \": \" + value\n      }, errors);\n    }\n\n    return 0;\n  };\n\n  Image.prototype.applySize = function (element) {\n    if (this.pixelWidth || this.pixelHeight) {\n      if (this.pixelWidth) {\n        element.style.width = this.pixelWidth + \"px\";\n      }\n\n      if (this.pixelHeight) {\n        element.style.height = this.pixelHeight + \"px\";\n      }\n    } else {\n      switch (this.size) {\n        case Enums.Size.Stretch:\n          element.style.width = \"100%\";\n          break;\n\n        case Enums.Size.Auto:\n          element.style.maxWidth = \"100%\";\n          break;\n\n        case Enums.Size.Small:\n          element.style.width = this.hostConfig.imageSizes.small + \"px\";\n          break;\n\n        case Enums.Size.Large:\n          element.style.width = this.hostConfig.imageSizes.large + \"px\";\n          break;\n\n        case Enums.Size.Medium:\n          element.style.width = this.hostConfig.imageSizes.medium + \"px\";\n          break;\n      }\n    }\n  };\n\n  Object.defineProperty(Image.prototype, \"useDefaultSizing\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Image.prototype.internalRender = function () {\n    var _this = this;\n\n    var element = null;\n\n    if (!Utils.isNullOrEmpty(this.url)) {\n      element = document.createElement(\"div\");\n      element.style.display = \"flex\";\n      element.style.alignItems = \"flex-start\";\n\n      element.onkeypress = function (e) {\n        if (_this.selectAction) {\n          if (e.keyCode == 13 || e.keyCode == 32) {\n            // enter or space pressed\n            _this.selectAction.execute();\n          }\n        }\n      };\n\n      element.onclick = function (e) {\n        if (_this.selectAction) {\n          _this.selectAction.execute();\n\n          e.cancelBubble = true;\n        }\n      };\n\n      switch (this.horizontalAlignment) {\n        case Enums.HorizontalAlignment.Center:\n          element.style.justifyContent = \"center\";\n          break;\n\n        case Enums.HorizontalAlignment.Right:\n          element.style.justifyContent = \"flex-end\";\n          break;\n\n        default:\n          element.style.justifyContent = \"flex-start\";\n          break;\n      } // Cache hostConfig to avoid walking the parent hierarchy multiple times\n\n\n      var hostConfig = this.hostConfig;\n      var imageElement = document.createElement(\"img\");\n\n      imageElement.onload = function (e) {\n        raiseImageLoadedEvent(_this);\n      };\n\n      imageElement.onerror = function (e) {\n        var card = _this.getRootElement();\n\n        _this.renderedElement.innerHTML = \"\";\n\n        if (card && card.designMode) {\n          var errorElement = document.createElement(\"div\");\n          errorElement.style.display = \"flex\";\n          errorElement.style.alignItems = \"center\";\n          errorElement.style.justifyContent = \"center\";\n          errorElement.style.backgroundColor = \"#EEEEEE\";\n          errorElement.style.color = \"black\";\n          errorElement.innerText = \":-(\";\n          errorElement.style.padding = \"10px\";\n\n          _this.applySize(errorElement);\n\n          _this.renderedElement.appendChild(errorElement);\n        }\n\n        raiseImageLoadedEvent(_this);\n      };\n\n      imageElement.style.maxHeight = \"100%\";\n      imageElement.style.minWidth = \"0\";\n      imageElement.classList.add(hostConfig.makeCssClassName(\"ac-image\"));\n\n      if (this.selectAction != null && hostConfig.supportsInteractivity) {\n        imageElement.tabIndex = 0;\n        imageElement.setAttribute(\"role\", \"button\");\n        imageElement.setAttribute(\"aria-label\", this.selectAction.title);\n        imageElement.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\n      }\n\n      this.applySize(imageElement);\n\n      if (this.style === Enums.ImageStyle.Person) {\n        imageElement.style.borderRadius = \"50%\";\n        imageElement.style.backgroundPosition = \"50% 50%\";\n        imageElement.style.backgroundRepeat = \"no-repeat\";\n      }\n\n      if (!Utils.isNullOrEmpty(this.backgroundColor)) {\n        imageElement.style.backgroundColor = Utils.stringToCssColor(this.backgroundColor);\n      }\n\n      imageElement.src = this.url;\n      imageElement.alt = this.altText;\n      element.appendChild(imageElement);\n    }\n\n    return element;\n  };\n\n  Image.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    if (this._selectAction) {\n      Utils.setProperty(result, \"selectAction\", this._selectAction.toJSON());\n    }\n\n    Utils.setEnumProperty(Enums.ImageStyle, result, \"style\", this.style, Enums.ImageStyle.Default);\n    Utils.setProperty(result, \"backgroundColor\", this.backgroundColor);\n    Utils.setProperty(result, \"url\", this.url);\n    Utils.setEnumProperty(Enums.Size, result, \"size\", this.size, Enums.Size.Auto);\n\n    if (this.pixelWidth) {\n      Utils.setProperty(result, \"width\", this.pixelWidth + \"px\");\n    }\n\n    if (this.pixelHeight) {\n      Utils.setProperty(result, \"height\", this.pixelHeight + \"px\");\n    }\n\n    Utils.setProperty(result, \"altText\", this.altText);\n    return result;\n  };\n\n  Image.prototype.getJsonTypeName = function () {\n    return \"Image\";\n  };\n\n  Image.prototype.getActionById = function (id) {\n    var result = _super.prototype.getActionById.call(this, id);\n\n    if (!result && this.selectAction) {\n      result = this.selectAction.getActionById(id);\n    }\n\n    return result;\n  };\n\n  Image.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.url = json[\"url\"];\n    this.backgroundColor = json[\"backgroundColor\"];\n    var styleString = json[\"style\"];\n\n    if (styleString && typeof styleString === \"string\" && styleString.toLowerCase() === \"normal\") {\n      this.style = Enums.ImageStyle.Default;\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The Image.style value \\\"normal\\\" is deprecated and will be removed. Use \\\"default\\\" instead.\"\n      }, errors);\n    } else {\n      this.style = Utils.getEnumValueOrDefault(Enums.ImageStyle, styleString, this.style);\n    }\n\n    this.size = Utils.getEnumValueOrDefault(Enums.Size, json[\"size\"], this.size);\n    this.altText = json[\"altText\"]; // pixelWidth and pixelHeight are only parsed for backwards compatibility.\n    // Payloads should use the width and height proerties instead.\n\n    if (json[\"pixelWidth\"] && typeof json[\"pixelWidth\"] === \"number\") {\n      this.pixelWidth = json[\"pixelWidth\"];\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The pixelWidth property is deprecated and will be removed. Use the width property instead.\"\n      }, errors);\n    }\n\n    if (json[\"pixelHeight\"] && typeof json[\"pixelHeight\"] === \"number\") {\n      this.pixelHeight = json[\"pixelHeight\"];\n      raiseParseError({\n        error: Enums.ValidationError.Deprecated,\n        message: \"The pixelHeight property is deprecated and will be removed. Use the height property instead.\"\n      }, errors);\n    }\n\n    var size = this.parseDimension(\"width\", json[\"width\"], errors);\n\n    if (size > 0) {\n      this.pixelWidth = size;\n    }\n\n    size = this.parseDimension(\"height\", json[\"height\"], errors);\n\n    if (size > 0) {\n      this.pixelHeight = size;\n    }\n\n    this.selectAction = createActionInstance(this, json[\"selectAction\"], errors);\n  };\n\n  Image.prototype.getResourceInformation = function () {\n    if (!Utils.isNullOrEmpty(this.url)) {\n      return [{\n        url: this.url,\n        mimeType: \"image\"\n      }];\n    } else {\n      return [];\n    }\n  };\n\n  Image.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak + '\\n';\n    }\n\n    return null;\n  };\n\n  Object.defineProperty(Image.prototype, \"selectAction\", {\n    get: function () {\n      return this._selectAction;\n    },\n    set: function (value) {\n      this._selectAction = value;\n\n      if (this._selectAction) {\n        this._selectAction.setParent(this);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Image;\n}(CardElement);\n\nexports.Image = Image;\n\nvar ImageSet =\n/** @class */\nfunction (_super) {\n  __extends(ImageSet, _super);\n\n  function ImageSet() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._images = [];\n    _this.imageSize = Enums.Size.Medium;\n    return _this;\n  }\n\n  ImageSet.prototype.internalRender = function () {\n    var element = null;\n\n    if (this._images.length > 0) {\n      element = document.createElement(\"div\");\n      element.style.display = \"flex\";\n      element.style.flexWrap = \"wrap\";\n\n      for (var i = 0; i < this._images.length; i++) {\n        this._images[i].size = this.imageSize;\n\n        var renderedImage = this._images[i].render();\n\n        renderedImage.style.display = \"inline-flex\";\n        renderedImage.style.margin = \"0px\";\n        renderedImage.style.marginRight = \"10px\";\n        renderedImage.style.maxHeight = this.hostConfig.imageSet.maxImageHeight + \"px\";\n        Utils.appendChild(element, renderedImage);\n      }\n    }\n\n    return element;\n  };\n\n  ImageSet.prototype.getItemCount = function () {\n    return this._images.length;\n  };\n\n  ImageSet.prototype.getItemAt = function (index) {\n    return this._images[index];\n  };\n\n  ImageSet.prototype.getResourceInformation = function () {\n    var result = [];\n\n    for (var _i = 0, _a = this._images; _i < _a.length; _i++) {\n      var image = _a[_i];\n      result = result.concat(image.getResourceInformation());\n    }\n\n    return result;\n  };\n\n  ImageSet.prototype.removeItem = function (item) {\n    if (item instanceof Image) {\n      var itemIndex = this._images.indexOf(item);\n\n      if (itemIndex >= 0) {\n        this._images.splice(itemIndex, 1);\n\n        item.setParent(null);\n        this.updateLayout();\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  ImageSet.prototype.getJsonTypeName = function () {\n    return \"ImageSet\";\n  };\n\n  ImageSet.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setEnumProperty(Enums.Size, result, \"imageSize\", this.imageSize, Enums.Size.Medium);\n\n    if (this._images.length > 0) {\n      var images = [];\n\n      for (var _i = 0, _a = this._images; _i < _a.length; _i++) {\n        var image = _a[_i];\n        images.push(image.toJSON());\n      }\n\n      Utils.setProperty(result, \"images\", images);\n    }\n\n    return result;\n  };\n\n  ImageSet.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.imageSize = Utils.getEnumValueOrDefault(Enums.Size, json[\"imageSize\"], Enums.Size.Medium);\n\n    if (json[\"images\"] != null) {\n      var jsonImages = json[\"images\"];\n      this._images = [];\n\n      for (var i = 0; i < jsonImages.length; i++) {\n        var image = new Image();\n        image.parse(jsonImages[i], errors);\n        this.addImage(image);\n      }\n    }\n  };\n\n  ImageSet.prototype.addImage = function (image) {\n    if (!image.parent) {\n      this._images.push(image);\n\n      image.setParent(this);\n    } else {\n      throw new Error(\"This image already belongs to another ImageSet\");\n    }\n  };\n\n  ImageSet.prototype.indexOf = function (cardElement) {\n    return cardElement instanceof Image ? this._images.indexOf(cardElement) : -1;\n  };\n\n  ImageSet.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak;\n    }\n\n    var speak = null;\n\n    if (this._images.length > 0) {\n      speak = '';\n\n      for (var i = 0; i < this._images.length; i++) {\n        speak += this._images[i].renderSpeech();\n      }\n    }\n\n    return speak;\n  };\n\n  return ImageSet;\n}(CardElementContainer);\n\nexports.ImageSet = ImageSet;\n\nvar MediaSource =\n/** @class */\nfunction () {\n  function MediaSource(url, mimeType) {\n    if (url === void 0) {\n      url = undefined;\n    }\n\n    if (mimeType === void 0) {\n      mimeType = undefined;\n    }\n\n    this.url = url;\n    this.mimeType = mimeType;\n  }\n\n  MediaSource.prototype.parse = function (json, errors) {\n    this.mimeType = json[\"mimeType\"];\n    this.url = json[\"url\"];\n  };\n\n  MediaSource.prototype.toJSON = function () {\n    return {\n      mimeType: this.mimeType,\n      url: this.url\n    };\n  };\n\n  return MediaSource;\n}();\n\nexports.MediaSource = MediaSource;\n\nvar Media =\n/** @class */\nfunction (_super) {\n  __extends(Media, _super);\n\n  function Media() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.sources = [];\n    return _this;\n  }\n\n  Media.prototype.getPosterUrl = function () {\n    return this.poster ? this.poster : this.hostConfig.media.defaultPoster;\n  };\n\n  Media.prototype.processSources = function () {\n    this._selectedSources = [];\n    this._selectedMediaType = undefined;\n\n    for (var _i = 0, _a = this.sources; _i < _a.length; _i++) {\n      var source = _a[_i];\n      var mimeComponents = source.mimeType.split('/');\n\n      if (mimeComponents.length == 2) {\n        if (!this._selectedMediaType) {\n          var index = Media.supportedMediaTypes.indexOf(mimeComponents[0]);\n\n          if (index >= 0) {\n            this._selectedMediaType = Media.supportedMediaTypes[index];\n          }\n        }\n\n        if (mimeComponents[0] == this._selectedMediaType) {\n          this._selectedSources.push(source);\n        }\n      }\n    }\n  };\n\n  Media.prototype.renderPoster = function () {\n    var _this = this;\n\n    var playButtonArrowWidth = 12;\n    var playButtonArrowHeight = 15;\n    var posterRootElement = document.createElement(\"div\");\n    posterRootElement.className = \"ac-media-poster\";\n    posterRootElement.setAttribute(\"role\", \"contentinfo\");\n    posterRootElement.setAttribute(\"aria-label\", this.altText ? this.altText : \"Media content\");\n    posterRootElement.style.position = \"relative\";\n    posterRootElement.style.display = \"flex\";\n    var posterUrl = this.getPosterUrl();\n\n    if (posterUrl) {\n      var posterImageElement_1 = document.createElement(\"img\");\n      posterImageElement_1.style.width = \"100%\";\n      posterImageElement_1.style.height = \"100%\";\n\n      posterImageElement_1.onerror = function (e) {\n        posterImageElement_1.parentNode.removeChild(posterImageElement_1);\n        posterRootElement.classList.add(\"empty\");\n        posterRootElement.style.minHeight = \"150px\";\n      };\n\n      posterImageElement_1.src = posterUrl;\n      posterRootElement.appendChild(posterImageElement_1);\n    } else {\n      posterRootElement.classList.add(\"empty\");\n      posterRootElement.style.minHeight = \"150px\";\n    }\n\n    if (this.hostConfig.supportsInteractivity && this._selectedSources.length > 0) {\n      var playButtonOuterElement = document.createElement(\"div\");\n      playButtonOuterElement.setAttribute(\"role\", \"button\");\n      playButtonOuterElement.setAttribute(\"aria-label\", \"Play media\");\n      playButtonOuterElement.className = \"ac-media-playButton\";\n      playButtonOuterElement.style.display = \"flex\";\n      playButtonOuterElement.style.alignItems = \"center\";\n      playButtonOuterElement.style.justifyContent = \"center\";\n\n      playButtonOuterElement.onclick = function (e) {\n        if (_this.hostConfig.media.allowInlinePlayback) {\n          var mediaPlayerElement = _this.renderMediaPlayer();\n\n          _this.renderedElement.innerHTML = \"\";\n\n          _this.renderedElement.appendChild(mediaPlayerElement);\n\n          mediaPlayerElement.play();\n        } else {\n          if (Media.onPlay) {\n            Media.onPlay(_this);\n          }\n        }\n      };\n\n      var playButtonInnerElement = document.createElement(\"div\");\n      playButtonInnerElement.className = \"ac-media-playButton-arrow\";\n      playButtonInnerElement.style.width = playButtonArrowWidth + \"px\";\n      playButtonInnerElement.style.height = playButtonArrowHeight + \"px\";\n      playButtonInnerElement.style.borderTopWidth = playButtonArrowHeight / 2 + \"px\";\n      playButtonInnerElement.style.borderBottomWidth = playButtonArrowHeight / 2 + \"px\";\n      playButtonInnerElement.style.borderLeftWidth = playButtonArrowWidth + \"px\";\n      playButtonInnerElement.style.borderRightWidth = \"0\";\n      playButtonInnerElement.style.borderStyle = \"solid\";\n      playButtonInnerElement.style.borderTopColor = \"transparent\";\n      playButtonInnerElement.style.borderRightColor = \"transparent\";\n      playButtonInnerElement.style.borderBottomColor = \"transparent\";\n      playButtonInnerElement.style.transform = \"translate(\" + playButtonArrowWidth / 10 + \"px,0px)\";\n      playButtonOuterElement.appendChild(playButtonInnerElement);\n      var playButtonContainer = document.createElement(\"div\");\n      playButtonContainer.style.position = \"absolute\";\n      playButtonContainer.style.left = \"0\";\n      playButtonContainer.style.top = \"0\";\n      playButtonContainer.style.width = \"100%\";\n      playButtonContainer.style.height = \"100%\";\n      playButtonContainer.style.display = \"flex\";\n      playButtonContainer.style.justifyContent = \"center\";\n      playButtonContainer.style.alignItems = \"center\";\n      playButtonContainer.appendChild(playButtonOuterElement);\n      posterRootElement.appendChild(playButtonContainer);\n    }\n\n    return posterRootElement;\n  };\n\n  Media.prototype.renderMediaPlayer = function () {\n    var mediaElement;\n\n    if (this._selectedMediaType == \"video\") {\n      var videoPlayer = document.createElement(\"video\");\n      var posterUrl = this.getPosterUrl();\n\n      if (posterUrl) {\n        videoPlayer.poster = posterUrl;\n      }\n\n      mediaElement = videoPlayer;\n    } else {\n      mediaElement = document.createElement(\"audio\");\n    }\n\n    mediaElement.controls = true;\n    mediaElement.preload = \"none\";\n    mediaElement.style.width = \"100%\";\n\n    for (var _i = 0, _a = this.sources; _i < _a.length; _i++) {\n      var source = _a[_i];\n      var src = document.createElement(\"source\");\n      src.src = source.url;\n      src.type = source.mimeType;\n      mediaElement.appendChild(src);\n    }\n\n    return mediaElement;\n  };\n\n  Media.prototype.internalRender = function () {\n    var element = document.createElement(\"div\");\n    element.className = this.hostConfig.makeCssClassName(\"ac-media\");\n    this.processSources();\n    element.appendChild(this.renderPoster());\n    return element;\n  };\n\n  Media.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.poster = json[\"poster\"];\n    this.altText = json[\"altText\"];\n\n    if (json[\"sources\"] != null) {\n      var jsonSources = json[\"sources\"];\n      this.sources = [];\n\n      for (var i = 0; i < jsonSources.length; i++) {\n        var source = new MediaSource();\n        source.parse(jsonSources[i], errors);\n        this.sources.push(source);\n      }\n    }\n  };\n\n  Media.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"poster\", this.poster);\n    Utils.setProperty(result, \"altText\", this.altText);\n\n    if (this.sources.length > 0) {\n      var serializedSources = [];\n\n      for (var _i = 0, _a = this.sources; _i < _a.length; _i++) {\n        var source = _a[_i];\n        serializedSources.push(source.toJSON());\n      }\n\n      Utils.setProperty(result, \"sources\", serializedSources);\n    }\n\n    return result;\n  };\n\n  Media.prototype.getJsonTypeName = function () {\n    return \"Media\";\n  };\n\n  Media.prototype.getResourceInformation = function () {\n    var result = [];\n    var posterUrl = this.getPosterUrl();\n\n    if (!Utils.isNullOrEmpty(posterUrl)) {\n      result.push({\n        url: posterUrl,\n        mimeType: \"image\"\n      });\n    }\n\n    for (var _i = 0, _a = this.sources; _i < _a.length; _i++) {\n      var mediaSource = _a[_i];\n\n      if (!Utils.isNullOrEmpty(mediaSource.url)) {\n        result.push({\n          url: mediaSource.url,\n          mimeType: mediaSource.mimeType\n        });\n      }\n    }\n\n    return result;\n  };\n\n  Media.prototype.renderSpeech = function () {\n    return this.altText;\n  };\n\n  Object.defineProperty(Media.prototype, \"selectedMediaType\", {\n    get: function () {\n      return this._selectedMediaType;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Media.supportedMediaTypes = [\"audio\", \"video\"];\n  return Media;\n}(CardElement);\n\nexports.Media = Media;\n\nvar Input =\n/** @class */\nfunction (_super) {\n  __extends(Input, _super);\n\n  function Input() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Input.prototype.valueChanged = function () {\n    if (this.onValueChanged) {\n      this.onValueChanged(this);\n    }\n  };\n\n  Input.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"title\", this.title);\n    Utils.setProperty(result, \"value\", this.renderedElement ? this.value : this.defaultValue);\n    return result;\n  };\n\n  Input.prototype.validate = function () {\n    if (!this.id) {\n      return [{\n        error: Enums.ValidationError.PropertyCantBeNull,\n        message: \"All inputs must have a unique Id\"\n      }];\n    } else {\n      return [];\n    }\n  };\n\n  Input.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.id = json[\"id\"];\n    this.defaultValue = json[\"value\"];\n  };\n\n  Input.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak;\n    }\n\n    if (this.title) {\n      return '<s>' + this.title + '</s>\\n';\n    }\n\n    return null;\n  };\n\n  Input.prototype.getAllInputs = function () {\n    return [this];\n  };\n\n  Object.defineProperty(Input.prototype, \"isInteractive\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Input;\n}(CardElement);\n\nexports.Input = Input;\n\nvar TextInput =\n/** @class */\nfunction (_super) {\n  __extends(TextInput, _super);\n\n  function TextInput() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.style = Enums.InputTextStyle.Text;\n    return _this;\n  }\n\n  TextInput.prototype.internalRender = function () {\n    var _this = this;\n\n    if (this.isMultiline) {\n      this._textareaElement = document.createElement(\"textarea\");\n      this._textareaElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-textInput\", \"ac-multiline\");\n      this._textareaElement.style.width = \"100%\";\n      this._textareaElement.tabIndex = 0;\n\n      if (!Utils.isNullOrEmpty(this.placeholder)) {\n        this._textareaElement.placeholder = this.placeholder;\n\n        this._textareaElement.setAttribute(\"aria-label\", this.placeholder);\n      }\n\n      if (!Utils.isNullOrEmpty(this.defaultValue)) {\n        this._textareaElement.value = this.defaultValue;\n      }\n\n      if (this.maxLength > 0) {\n        this._textareaElement.maxLength = this.maxLength;\n      }\n\n      this._textareaElement.oninput = function () {\n        _this.valueChanged();\n      };\n\n      return this._textareaElement;\n    } else {\n      this._inputElement = document.createElement(\"input\");\n      this._inputElement.type = Enums.InputTextStyle[this.style].toLowerCase();\n      this._inputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-textInput\");\n      this._inputElement.style.width = \"100%\";\n      this._inputElement.tabIndex = 0;\n\n      if (!Utils.isNullOrEmpty(this.placeholder)) {\n        this._inputElement.placeholder = this.placeholder;\n\n        this._inputElement.setAttribute(\"aria-label\", this.placeholder);\n      }\n\n      if (!Utils.isNullOrEmpty(this.defaultValue)) {\n        this._inputElement.value = this.defaultValue;\n      }\n\n      if (this.maxLength > 0) {\n        this._inputElement.maxLength = this.maxLength;\n      }\n\n      this._inputElement.oninput = function () {\n        _this.valueChanged();\n      };\n\n      return this._inputElement;\n    }\n  };\n\n  TextInput.prototype.getJsonTypeName = function () {\n    return \"Input.Text\";\n  };\n\n  TextInput.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"placeholder\", this.placeholder);\n    Utils.setProperty(result, \"maxLength\", this.maxLength, 0);\n    Utils.setProperty(result, \"isMultiline\", this.isMultiline, false);\n    Utils.setEnumProperty(Enums.InputTextStyle, result, \"style\", this.style, Enums.InputTextStyle.Text);\n    return result;\n  };\n\n  TextInput.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.maxLength = json[\"maxLength\"];\n    this.isMultiline = json[\"isMultiline\"];\n    this.placeholder = json[\"placeholder\"];\n    this.style = Utils.getEnumValueOrDefault(Enums.InputTextStyle, json[\"style\"], this.style);\n  };\n\n  Object.defineProperty(TextInput.prototype, \"value\", {\n    get: function () {\n      if (this.isMultiline) {\n        return this._textareaElement ? this._textareaElement.value : null;\n      } else {\n        return this._inputElement ? this._inputElement.value : null;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return TextInput;\n}(Input);\n\nexports.TextInput = TextInput;\n\nvar ToggleInput =\n/** @class */\nfunction (_super) {\n  __extends(ToggleInput, _super);\n\n  function ToggleInput() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.valueOn = \"true\";\n    _this.valueOff = \"false\";\n    return _this;\n  }\n\n  ToggleInput.prototype.internalRender = function () {\n    var _this = this;\n\n    var element = document.createElement(\"div\");\n    element.className = this.hostConfig.makeCssClassName(\"ac-input\");\n    element.style.width = \"100%\";\n    element.style.display = \"flex\";\n    element.style.alignItems = \"center\";\n    this._checkboxInputElement = document.createElement(\"input\");\n    this._checkboxInputElement.id = generateUniqueId();\n    this._checkboxInputElement.type = \"checkbox\";\n    this._checkboxInputElement.style.display = \"inline-block\";\n    this._checkboxInputElement.style.verticalAlign = \"middle\";\n    this._checkboxInputElement.style.margin = \"0\";\n    this._checkboxInputElement.style.flex = \"0 0 auto\";\n\n    this._checkboxInputElement.setAttribute(\"aria-label\", this.title);\n\n    this._checkboxInputElement.tabIndex = 0;\n\n    if (this.defaultValue == this.valueOn) {\n      this._checkboxInputElement.checked = true;\n    }\n\n    this._checkboxInputElement.onchange = function () {\n      _this.valueChanged();\n    };\n\n    Utils.appendChild(element, this._checkboxInputElement);\n\n    if (!Utils.isNullOrEmpty(this.title) || this.isDesignMode()) {\n      var label = new Label();\n      label.setParent(this);\n      label.forElementId = this._checkboxInputElement.id;\n      label.hostConfig = this.hostConfig;\n      label.text = Utils.isNullOrEmpty(this.title) ? this.getJsonTypeName() : this.title;\n      label.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\n      var labelElement = label.render();\n      labelElement.style.display = \"inline-block\";\n      labelElement.style.flex = \"1 1 auto\";\n      labelElement.style.verticalAlign = \"middle\";\n      var spacerElement = document.createElement(\"div\");\n      spacerElement.style.width = \"6px\";\n      Utils.appendChild(element, spacerElement);\n      Utils.appendChild(element, labelElement);\n    }\n\n    return element;\n  };\n\n  ToggleInput.prototype.getJsonTypeName = function () {\n    return \"Input.Toggle\";\n  };\n\n  ToggleInput.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"valueOn\", this.valueOn, \"true\");\n    Utils.setProperty(result, \"valueOff\", this.valueOff, \"false\");\n    return result;\n  };\n\n  ToggleInput.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.title = json[\"title\"];\n    this.valueOn = Utils.getValueOrDefault(json[\"valueOn\"], this.valueOn);\n    this.valueOff = Utils.getValueOrDefault(json[\"valueOff\"], this.valueOff);\n  };\n\n  Object.defineProperty(ToggleInput.prototype, \"value\", {\n    get: function () {\n      if (this._checkboxInputElement) {\n        return this._checkboxInputElement.checked ? this.valueOn : this.valueOff;\n      } else {\n        return null;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ToggleInput;\n}(Input);\n\nexports.ToggleInput = ToggleInput;\n\nvar Choice =\n/** @class */\nfunction () {\n  function Choice(title, value) {\n    if (title === void 0) {\n      title = undefined;\n    }\n\n    if (value === void 0) {\n      value = undefined;\n    }\n\n    this.title = title;\n    this.value = value;\n  }\n\n  Choice.prototype.toJSON = function () {\n    return {\n      title: this.title,\n      value: this.value\n    };\n  };\n\n  return Choice;\n}();\n\nexports.Choice = Choice;\n\nvar ChoiceSetInput =\n/** @class */\nfunction (_super) {\n  __extends(ChoiceSetInput, _super);\n\n  function ChoiceSetInput() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.choices = [];\n    return _this;\n  }\n\n  ChoiceSetInput.getUniqueCategoryName = function () {\n    var uniqueCwtegoryName = \"__ac-category\" + ChoiceSetInput.uniqueCategoryCounter;\n    ChoiceSetInput.uniqueCategoryCounter++;\n    return uniqueCwtegoryName;\n  };\n\n  ChoiceSetInput.prototype.internalRender = function () {\n    var _this = this;\n\n    if (!this.isMultiSelect) {\n      if (this.isCompact) {\n        // Render as a combo box\n        this._selectElement = document.createElement(\"select\");\n        this._selectElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-multichoiceInput\");\n        this._selectElement.style.width = \"100%\";\n        var option = document.createElement(\"option\");\n        option.selected = true;\n        option.disabled = true;\n        option.hidden = true;\n        option.value = \"\";\n\n        if (this.placeholder) {\n          option.text = this.placeholder;\n        }\n\n        Utils.appendChild(this._selectElement, option);\n\n        for (var i = 0; i < this.choices.length; i++) {\n          var option_1 = document.createElement(\"option\");\n          option_1.value = this.choices[i].value;\n          option_1.text = this.choices[i].title;\n          option_1.setAttribute(\"aria-label\", this.choices[i].title);\n\n          if (this.choices[i].value == this.defaultValue) {\n            option_1.selected = true;\n          }\n\n          Utils.appendChild(this._selectElement, option_1);\n        }\n\n        this._selectElement.onchange = function () {\n          _this.valueChanged();\n        };\n\n        return this._selectElement;\n      } else {\n        // Render as a series of radio buttons\n        var uniqueCategoryName = ChoiceSetInput.getUniqueCategoryName();\n        var element = document.createElement(\"div\");\n        element.className = this.hostConfig.makeCssClassName(\"ac-input\");\n        element.style.width = \"100%\";\n        this._toggleInputs = [];\n\n        for (var i_1 = 0; i_1 < this.choices.length; i_1++) {\n          var radioInput = document.createElement(\"input\");\n          radioInput.id = generateUniqueId();\n          radioInput.type = \"radio\";\n          radioInput.style.margin = \"0\";\n          radioInput.style.display = \"inline-block\";\n          radioInput.style.verticalAlign = \"middle\";\n          radioInput.name = Utils.isNullOrEmpty(this.id) ? uniqueCategoryName : this.id;\n          radioInput.value = this.choices[i_1].value;\n          radioInput.style.flex = \"0 0 auto\";\n          radioInput.setAttribute(\"aria-label\", this.choices[i_1].title);\n\n          if (this.choices[i_1].value == this.defaultValue) {\n            radioInput.checked = true;\n          }\n\n          radioInput.onchange = function () {\n            _this.valueChanged();\n          };\n\n          this._toggleInputs.push(radioInput);\n\n          var label = new Label();\n          label.setParent(this);\n          label.forElementId = radioInput.id;\n          label.hostConfig = this.hostConfig;\n          label.text = Utils.isNullOrEmpty(this.choices[i_1].title) ? \"Choice \" + i_1 : this.choices[i_1].title;\n          label.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\n          var labelElement = label.render();\n          labelElement.style.display = \"inline-block\";\n          labelElement.style.flex = \"1 1 auto\";\n          labelElement.style.marginLeft = \"6px\";\n          labelElement.style.verticalAlign = \"middle\";\n          var spacerElement = document.createElement(\"div\");\n          spacerElement.style.width = \"6px\";\n          var compoundInput = document.createElement(\"div\");\n          compoundInput.style.display = \"flex\";\n          Utils.appendChild(compoundInput, radioInput);\n          Utils.appendChild(compoundInput, spacerElement);\n          Utils.appendChild(compoundInput, labelElement);\n          Utils.appendChild(element, compoundInput);\n        }\n\n        return element;\n      }\n    } else {\n      // Render as a list of toggle inputs\n      var defaultValues = this.defaultValue ? this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator) : null;\n      var element = document.createElement(\"div\");\n      element.className = this.hostConfig.makeCssClassName(\"ac-input\");\n      element.style.width = \"100%\";\n      this._toggleInputs = [];\n\n      for (var i_2 = 0; i_2 < this.choices.length; i_2++) {\n        var checkboxInput = document.createElement(\"input\");\n        checkboxInput.id = generateUniqueId();\n        checkboxInput.type = \"checkbox\";\n        checkboxInput.style.margin = \"0\";\n        checkboxInput.style.display = \"inline-block\";\n        checkboxInput.style.verticalAlign = \"middle\";\n        checkboxInput.value = this.choices[i_2].value;\n        checkboxInput.style.flex = \"0 0 auto\";\n        checkboxInput.setAttribute(\"aria-label\", this.choices[i_2].title);\n\n        if (defaultValues) {\n          if (defaultValues.indexOf(this.choices[i_2].value) >= 0) {\n            checkboxInput.checked = true;\n          }\n        }\n\n        checkboxInput.onchange = function () {\n          _this.valueChanged();\n        };\n\n        this._toggleInputs.push(checkboxInput);\n\n        var label = new Label();\n        label.setParent(this);\n        label.forElementId = checkboxInput.id;\n        label.hostConfig = this.hostConfig;\n        label.text = Utils.isNullOrEmpty(this.choices[i_2].title) ? \"Choice \" + i_2 : this.choices[i_2].title;\n        label.useMarkdown = AdaptiveCard.useMarkdownInRadioButtonAndCheckbox;\n        var labelElement = label.render();\n        labelElement.style.display = \"inline-block\";\n        labelElement.style.flex = \"1 1 auto\"; // labelElement.style.marginLeft = \"6px\";\n\n        labelElement.style.verticalAlign = \"middle\";\n        var spacerElement = document.createElement(\"div\");\n        spacerElement.style.width = \"6px\";\n        var compoundInput = document.createElement(\"div\");\n        compoundInput.style.display = \"flex\";\n        compoundInput.style.alignItems = \"center\";\n        Utils.appendChild(compoundInput, checkboxInput);\n        Utils.appendChild(compoundInput, spacerElement);\n        Utils.appendChild(compoundInput, labelElement);\n        Utils.appendChild(element, compoundInput);\n      }\n\n      return element;\n    }\n  };\n\n  ChoiceSetInput.prototype.getJsonTypeName = function () {\n    return \"Input.ChoiceSet\";\n  };\n\n  ChoiceSetInput.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"placeholder\", this.placeholder);\n\n    if (this.choices.length > 0) {\n      var choices = [];\n\n      for (var _i = 0, _a = this.choices; _i < _a.length; _i++) {\n        var choice = _a[_i];\n        choices.push(choice.toJSON());\n      }\n\n      Utils.setProperty(result, \"choices\", choices);\n    }\n\n    if (!this.isCompact) {\n      Utils.setProperty(result, \"style\", \"expanded\", false);\n    }\n\n    Utils.setProperty(result, \"isMultiSelect\", this.isMultiSelect, false);\n    return result;\n  };\n\n  ChoiceSetInput.prototype.validate = function () {\n    var result = [];\n\n    if (this.choices.length == 0) {\n      result = [{\n        error: Enums.ValidationError.CollectionCantBeEmpty,\n        message: \"An Input.ChoiceSet must have at least one choice defined.\"\n      }];\n    }\n\n    for (var i = 0; i < this.choices.length; i++) {\n      if (!this.choices[i].title || !this.choices[i].value) {\n        result = result.concat([{\n          error: Enums.ValidationError.PropertyCantBeNull,\n          message: \"All choices in an Input.ChoiceSet must have their title and value properties set.\"\n        }]);\n        break;\n      }\n    }\n\n    return result;\n  };\n\n  ChoiceSetInput.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.isCompact = !(json[\"style\"] === \"expanded\");\n    this.isMultiSelect = json[\"isMultiSelect\"];\n    this.placeholder = json[\"placeholder\"];\n    this.choices = [];\n\n    if (json[\"choices\"] != undefined) {\n      var choiceArray = json[\"choices\"];\n\n      for (var i = 0; i < choiceArray.length; i++) {\n        var choice = new Choice();\n        choice.title = choiceArray[i][\"title\"];\n        choice.value = choiceArray[i][\"value\"];\n        this.choices.push(choice);\n      }\n    }\n  };\n\n  Object.defineProperty(ChoiceSetInput.prototype, \"value\", {\n    get: function () {\n      if (!this.isMultiSelect) {\n        if (this.isCompact) {\n          return this._selectElement ? this._selectElement.value : null;\n        } else {\n          if (!this._toggleInputs || this._toggleInputs.length == 0) {\n            return null;\n          }\n\n          for (var i = 0; i < this._toggleInputs.length; i++) {\n            if (this._toggleInputs[i].checked) {\n              return this._toggleInputs[i].value;\n            }\n          }\n\n          return null;\n        }\n      } else {\n        if (!this._toggleInputs || this._toggleInputs.length == 0) {\n          return null;\n        }\n\n        var result = \"\";\n\n        for (var i = 0; i < this._toggleInputs.length; i++) {\n          if (this._toggleInputs[i].checked) {\n            if (result != \"\") {\n              result += this.hostConfig.choiceSetInputValueSeparator;\n            }\n\n            result += this._toggleInputs[i].value;\n          }\n        }\n\n        return result == \"\" ? null : result;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  ChoiceSetInput.uniqueCategoryCounter = 0;\n  return ChoiceSetInput;\n}(Input);\n\nexports.ChoiceSetInput = ChoiceSetInput;\n\nvar NumberInput =\n/** @class */\nfunction (_super) {\n  __extends(NumberInput, _super);\n\n  function NumberInput() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  NumberInput.prototype.internalRender = function () {\n    var _this = this;\n\n    this._numberInputElement = document.createElement(\"input\");\n\n    this._numberInputElement.setAttribute(\"type\", \"number\");\n\n    this._numberInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-numberInput\");\n\n    this._numberInputElement.setAttribute(\"min\", this.min);\n\n    this._numberInputElement.setAttribute(\"max\", this.max);\n\n    this._numberInputElement.style.width = \"100%\";\n    this._numberInputElement.tabIndex = 0;\n\n    if (!Utils.isNullOrEmpty(this.defaultValue)) {\n      this._numberInputElement.value = this.defaultValue;\n    }\n\n    if (!Utils.isNullOrEmpty(this.placeholder)) {\n      this._numberInputElement.placeholder = this.placeholder;\n\n      this._numberInputElement.setAttribute(\"aria-label\", this.placeholder);\n    }\n\n    this._numberInputElement.oninput = function () {\n      _this.valueChanged();\n    };\n\n    return this._numberInputElement;\n  };\n\n  NumberInput.prototype.getJsonTypeName = function () {\n    return \"Input.Number\";\n  };\n\n  NumberInput.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"placeholder\", this.placeholder);\n    Utils.setProperty(result, \"min\", this.min);\n    Utils.setProperty(result, \"max\", this.max);\n    return result;\n  };\n\n  NumberInput.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.placeholder = json[\"placeholder\"];\n    this.min = json[\"min\"];\n    this.max = json[\"max\"];\n  };\n\n  Object.defineProperty(NumberInput.prototype, \"value\", {\n    get: function () {\n      return this._numberInputElement ? this._numberInputElement.value : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return NumberInput;\n}(Input);\n\nexports.NumberInput = NumberInput;\n\nvar DateInput =\n/** @class */\nfunction (_super) {\n  __extends(DateInput, _super);\n\n  function DateInput() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DateInput.prototype.internalRender = function () {\n    this._dateInputElement = document.createElement(\"input\");\n\n    this._dateInputElement.setAttribute(\"type\", \"date\");\n\n    this._dateInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-dateInput\");\n    this._dateInputElement.style.width = \"100%\";\n\n    if (!Utils.isNullOrEmpty(this.defaultValue)) {\n      this._dateInputElement.value = this.defaultValue;\n    }\n\n    return this._dateInputElement;\n  };\n\n  DateInput.prototype.getJsonTypeName = function () {\n    return \"Input.Date\";\n  };\n\n  Object.defineProperty(DateInput.prototype, \"value\", {\n    get: function () {\n      return this._dateInputElement ? this._dateInputElement.value : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return DateInput;\n}(Input);\n\nexports.DateInput = DateInput;\n\nvar TimeInput =\n/** @class */\nfunction (_super) {\n  __extends(TimeInput, _super);\n\n  function TimeInput() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeInput.prototype.internalRender = function () {\n    this._timeInputElement = document.createElement(\"input\");\n\n    this._timeInputElement.setAttribute(\"type\", \"time\");\n\n    this._timeInputElement.className = this.hostConfig.makeCssClassName(\"ac-input\", \"ac-timeInput\");\n    this._timeInputElement.style.width = \"100%\";\n\n    if (!Utils.isNullOrEmpty(this.defaultValue)) {\n      this._timeInputElement.value = this.defaultValue;\n    }\n\n    return this._timeInputElement;\n  };\n\n  TimeInput.prototype.getJsonTypeName = function () {\n    return \"Input.Time\";\n  };\n\n  Object.defineProperty(TimeInput.prototype, \"value\", {\n    get: function () {\n      return this._timeInputElement ? this._timeInputElement.value : null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return TimeInput;\n}(Input);\n\nexports.TimeInput = TimeInput;\nvar ActionButtonState;\n\n(function (ActionButtonState) {\n  ActionButtonState[ActionButtonState[\"Normal\"] = 0] = \"Normal\";\n  ActionButtonState[ActionButtonState[\"Expanded\"] = 1] = \"Expanded\";\n  ActionButtonState[ActionButtonState[\"Subdued\"] = 2] = \"Subdued\";\n})(ActionButtonState || (ActionButtonState = {}));\n\nvar ActionButton =\n/** @class */\nfunction () {\n  function ActionButton(action, parentContainerStyle) {\n    this._element = null;\n    this._state = ActionButtonState.Normal;\n    this.onClick = null;\n    this.action = action;\n    this._parentContainerStyle = parentContainerStyle;\n  }\n\n  ActionButton.prototype.updateCssStyle = function () {\n    var hostConfig = this.action.parent.hostConfig;\n    this.action.renderedElement.className = hostConfig.makeCssClassName(\"ac-pushButton\");\n    this.action.renderedElement.classList.add(\"style-\" + this._parentContainerStyle);\n\n    if (this.action instanceof ShowCardAction) {\n      this.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"expandable\"));\n    }\n\n    this.action.renderedElement.classList.remove(hostConfig.makeCssClassName(\"expanded\"));\n    this.action.renderedElement.classList.remove(hostConfig.makeCssClassName(\"subdued\"));\n\n    switch (this._state) {\n      case ActionButtonState.Expanded:\n        this.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"expanded\"));\n        break;\n\n      case ActionButtonState.Subdued:\n        this.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"subdued\"));\n        break;\n    }\n\n    if (this.action.isPrimary) {\n      this.action.renderedElement.classList.add(hostConfig.makeCssClassName(\"primary\"));\n    }\n  };\n\n  ActionButton.prototype.render = function (alignment) {\n    var _this = this;\n\n    this.action.render();\n    this.action.renderedElement.style.flex = alignment === Enums.ActionAlignment.Stretch ? \"0 1 100%\" : \"0 1 auto\";\n\n    this.action.renderedElement.onclick = function (e) {\n      _this.click();\n    };\n\n    this.updateCssStyle();\n  };\n\n  ActionButton.prototype.click = function () {\n    if (this.onClick != null) {\n      this.onClick(this);\n    }\n  };\n\n  Object.defineProperty(ActionButton.prototype, \"state\", {\n    get: function () {\n      return this._state;\n    },\n    set: function (value) {\n      this._state = value;\n      this.updateCssStyle();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ActionButton;\n}();\n\nvar Action =\n/** @class */\nfunction () {\n  function Action() {\n    this._shouldFallback = false;\n    this._parent = null;\n    this._actionCollection = null; // hold the reference to its action collection\n\n    this._renderedElement = null;\n    this.requires = new HostConfig.HostCapabilities();\n  }\n\n  Action.prototype.setCollection = function (actionCollection) {\n    this._actionCollection = actionCollection;\n  };\n\n  Action.prototype.addCssClasses = function (element) {// Do nothing in base implementation\n  };\n\n  Action.prototype.toJSON = function () {\n    var result = {};\n    Utils.setProperty(result, \"type\", this.getJsonTypeName());\n    Utils.setProperty(result, \"id\", this.id);\n    Utils.setProperty(result, \"title\", this.title);\n    Utils.setProperty(result, \"iconUrl\", this.iconUrl);\n    return result;\n  };\n\n  Action.prototype.render = function () {\n    // Cache hostConfig for perf\n    var hostConfig = this.parent.hostConfig;\n    var buttonElement = document.createElement(\"button\");\n    buttonElement.className = hostConfig.makeCssClassName(\"ac-pushButton\");\n    this.addCssClasses(buttonElement);\n    buttonElement.setAttribute(\"aria-label\", this.title);\n    buttonElement.type = \"button\";\n    buttonElement.style.display = \"flex\";\n    buttonElement.style.alignItems = \"center\";\n    buttonElement.style.justifyContent = \"center\";\n    var hasTitle = !Utils.isNullOrEmpty(this.title);\n    var titleElement = document.createElement(\"div\");\n    titleElement.style.overflow = \"hidden\";\n    titleElement.style.textOverflow = \"ellipsis\";\n\n    if (!(hostConfig.actions.iconPlacement == Enums.ActionIconPlacement.AboveTitle || hostConfig.actions.allowTitleToWrap)) {\n      titleElement.style.whiteSpace = \"nowrap\";\n    }\n\n    if (hasTitle) {\n      titleElement.innerText = this.title;\n    }\n\n    if (Utils.isNullOrEmpty(this.iconUrl)) {\n      buttonElement.classList.add(\"noIcon\");\n      buttonElement.appendChild(titleElement);\n    } else {\n      var iconElement = document.createElement(\"img\");\n      iconElement.src = this.iconUrl;\n      iconElement.style.width = hostConfig.actions.iconSize + \"px\";\n      iconElement.style.height = hostConfig.actions.iconSize + \"px\";\n      iconElement.style.flex = \"0 0 auto\";\n\n      if (hostConfig.actions.iconPlacement == Enums.ActionIconPlacement.AboveTitle) {\n        buttonElement.classList.add(\"iconAbove\");\n        buttonElement.style.flexDirection = \"column\";\n\n        if (hasTitle) {\n          iconElement.style.marginBottom = \"4px\";\n        }\n      } else {\n        buttonElement.classList.add(\"iconLeft\");\n\n        if (hasTitle) {\n          iconElement.style.marginRight = \"4px\";\n        }\n      }\n\n      buttonElement.appendChild(iconElement);\n      buttonElement.appendChild(titleElement);\n    }\n\n    this._renderedElement = buttonElement;\n  };\n\n  Action.prototype.setParent = function (value) {\n    this._parent = value;\n  };\n\n  Action.prototype.execute = function () {\n    if (this.onExecute) {\n      this.onExecute(this);\n    }\n\n    raiseExecuteActionEvent(this);\n  }; // Expand the action card pane with a inline status card\n  // Null status will clear the status bar\n\n\n  Action.prototype.setStatus = function (status) {\n    if (this._actionCollection == null) {\n      return;\n    }\n\n    if (status) {\n      var statusCard = new InlineAdaptiveCard();\n      statusCard.parse(status);\n\n      this._actionCollection.showStatusCard(statusCard);\n    } else {\n      this._actionCollection.hideStatusCard();\n    }\n  };\n\n  Action.prototype.validate = function () {\n    return [];\n  };\n\n  Action.prototype.prepare = function (inputs) {// Do nothing in base implementation\n  };\n\n  ;\n\n  Action.prototype.parse = function (json, errors) {\n    raiseParseActionEvent(this, json, errors);\n    this.requires.parse(json[\"requires\"], errors);\n    this.id = json[\"id\"];\n\n    if (!json[\"title\"] && json[\"title\"] !== \"\") {\n      raiseParseError({\n        error: Enums.ValidationError.PropertyCantBeNull,\n        message: \"Actions should always have a title.\"\n      }, errors);\n    }\n\n    this.title = json[\"title\"];\n    this.iconUrl = json[\"iconUrl\"];\n  };\n\n  Action.prototype.remove = function () {\n    if (this._actionCollection) {\n      return this._actionCollection.removeAction(this);\n    }\n\n    return false;\n  };\n\n  Action.prototype.getAllInputs = function () {\n    return [];\n  };\n\n  Action.prototype.getResourceInformation = function () {\n    if (!Utils.isNullOrEmpty(this.iconUrl)) {\n      return [{\n        url: this.iconUrl,\n        mimeType: \"image\"\n      }];\n    } else {\n      return [];\n    }\n  };\n\n  Action.prototype.getActionById = function (id) {\n    if (this.id == id) {\n      return this;\n    }\n  };\n\n  Object.defineProperty(Action.prototype, \"parent\", {\n    get: function () {\n      return this._parent;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Action.prototype, \"renderedElement\", {\n    get: function () {\n      return this._renderedElement;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Action.prototype.shouldFallback = function () {\n    return this._shouldFallback || !this.requires.areAllMet(this.parent.hostConfig.hostCapabilities);\n  };\n\n  return Action;\n}();\n\nexports.Action = Action;\n\nvar SubmitAction =\n/** @class */\nfunction (_super) {\n  __extends(SubmitAction, _super);\n\n  function SubmitAction() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._isPrepared = false;\n    return _this;\n  }\n\n  SubmitAction.prototype.getJsonTypeName = function () {\n    return \"Action.Submit\";\n  };\n\n  SubmitAction.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"data\", this._originalData);\n    return result;\n  };\n\n  SubmitAction.prototype.prepare = function (inputs) {\n    if (this._originalData) {\n      this._processedData = JSON.parse(JSON.stringify(this._originalData));\n    } else {\n      this._processedData = {};\n    }\n\n    for (var i = 0; i < inputs.length; i++) {\n      var inputValue = inputs[i].value;\n\n      if (inputValue != null) {\n        this._processedData[inputs[i].id] = inputs[i].value;\n      }\n    }\n\n    this._isPrepared = true;\n  };\n\n  SubmitAction.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.data = json[\"data\"];\n  };\n\n  Object.defineProperty(SubmitAction.prototype, \"data\", {\n    get: function () {\n      return this._isPrepared ? this._processedData : this._originalData;\n    },\n    set: function (value) {\n      this._originalData = value;\n      this._isPrepared = false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return SubmitAction;\n}(Action);\n\nexports.SubmitAction = SubmitAction;\n\nvar OpenUrlAction =\n/** @class */\nfunction (_super) {\n  __extends(OpenUrlAction, _super);\n\n  function OpenUrlAction() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  OpenUrlAction.prototype.getJsonTypeName = function () {\n    return \"Action.OpenUrl\";\n  };\n\n  OpenUrlAction.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"url\", this.url);\n    return result;\n  };\n\n  OpenUrlAction.prototype.validate = function () {\n    if (!this.url) {\n      return [{\n        error: Enums.ValidationError.PropertyCantBeNull,\n        message: \"An Action.OpenUrl must have its url property set.\"\n      }];\n    } else {\n      return [];\n    }\n  };\n\n  OpenUrlAction.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.url = json[\"url\"];\n  };\n\n  return OpenUrlAction;\n}(Action);\n\nexports.OpenUrlAction = OpenUrlAction;\n\nvar HttpHeader =\n/** @class */\nfunction () {\n  function HttpHeader(name, value) {\n    if (name === void 0) {\n      name = \"\";\n    }\n\n    if (value === void 0) {\n      value = \"\";\n    }\n\n    this._value = new Utils.StringWithSubstitutions();\n    this.name = name;\n    this.value = value;\n  }\n\n  HttpHeader.prototype.toJSON = function () {\n    return {\n      name: this.name,\n      value: this._value.getOriginal()\n    };\n  };\n\n  HttpHeader.prototype.prepare = function (inputs) {\n    this._value.substituteInputValues(inputs, Utils.ContentTypes.applicationXWwwFormUrlencoded);\n  };\n\n  Object.defineProperty(HttpHeader.prototype, \"value\", {\n    get: function () {\n      return this._value.get();\n    },\n    set: function (newValue) {\n      this._value.set(newValue);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return HttpHeader;\n}();\n\nexports.HttpHeader = HttpHeader;\n\nvar HttpAction =\n/** @class */\nfunction (_super) {\n  __extends(HttpAction, _super);\n\n  function HttpAction() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._url = new Utils.StringWithSubstitutions();\n    _this._body = new Utils.StringWithSubstitutions();\n    _this._headers = [];\n    return _this;\n  }\n\n  HttpAction.prototype.getJsonTypeName = function () {\n    return \"Action.Http\";\n  };\n\n  HttpAction.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"method\", this.method);\n    Utils.setProperty(result, \"url\", this._url.getOriginal());\n    Utils.setProperty(result, \"body\", this._body.getOriginal());\n\n    if (this._headers.length > 0) {\n      var headers = [];\n\n      for (var _i = 0, _a = this._headers; _i < _a.length; _i++) {\n        var header = _a[_i];\n        headers.push(header.toJSON());\n      }\n\n      Utils.setProperty(result, \"headers\", headers);\n    }\n\n    return result;\n  };\n\n  HttpAction.prototype.validate = function () {\n    var result = [];\n\n    if (!this.url) {\n      result = [{\n        error: Enums.ValidationError.PropertyCantBeNull,\n        message: \"An Action.Http must have its url property set.\"\n      }];\n    }\n\n    if (this.headers.length > 0) {\n      for (var i = 0; i < this.headers.length; i++) {\n        if (!this.headers[i].name || !this.headers[i].value) {\n          result = result.concat([{\n            error: Enums.ValidationError.PropertyCantBeNull,\n            message: \"All headers of an Action.Http must have their name and value properties set.\"\n          }]);\n          break;\n        }\n      }\n    }\n\n    return result;\n  };\n\n  HttpAction.prototype.prepare = function (inputs) {\n    this._url.substituteInputValues(inputs, Utils.ContentTypes.applicationXWwwFormUrlencoded);\n\n    var contentType = Utils.ContentTypes.applicationJson;\n\n    for (var i = 0; i < this._headers.length; i++) {\n      this._headers[i].prepare(inputs);\n\n      if (this._headers[i].name && this._headers[i].name.toLowerCase() == \"content-type\") {\n        contentType = this._headers[i].value;\n      }\n    }\n\n    this._body.substituteInputValues(inputs, contentType);\n  };\n\n  ;\n\n  HttpAction.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.url = json[\"url\"];\n    this.method = json[\"method\"];\n    this.body = json[\"body\"];\n    this._headers = [];\n\n    if (json[\"headers\"] != null) {\n      var jsonHeaders = json[\"headers\"];\n\n      for (var i = 0; i < jsonHeaders.length; i++) {\n        var httpHeader = new HttpHeader();\n        httpHeader.name = jsonHeaders[i][\"name\"];\n        httpHeader.value = jsonHeaders[i][\"value\"];\n        this.headers.push(httpHeader);\n      }\n    }\n  };\n\n  Object.defineProperty(HttpAction.prototype, \"url\", {\n    get: function () {\n      return this._url.get();\n    },\n    set: function (value) {\n      this._url.set(value);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HttpAction.prototype, \"body\", {\n    get: function () {\n      return this._body.get();\n    },\n    set: function (value) {\n      this._body.set(value);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HttpAction.prototype, \"headers\", {\n    get: function () {\n      return this._headers ? this._headers : [];\n    },\n    set: function (value) {\n      this._headers = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return HttpAction;\n}(Action);\n\nexports.HttpAction = HttpAction;\n\nvar ShowCardAction =\n/** @class */\nfunction (_super) {\n  __extends(ShowCardAction, _super);\n\n  function ShowCardAction() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.card = new InlineAdaptiveCard();\n    return _this;\n  }\n\n  ShowCardAction.prototype.addCssClasses = function (element) {\n    _super.prototype.addCssClasses.call(this, element);\n\n    element.classList.add(this.parent.hostConfig.makeCssClassName(\"expandable\"));\n  };\n\n  ShowCardAction.prototype.getJsonTypeName = function () {\n    return \"Action.ShowCard\";\n  };\n\n  ShowCardAction.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    if (this.card) {\n      Utils.setProperty(result, \"card\", this.card.toJSON());\n    }\n\n    return result;\n  };\n\n  ShowCardAction.prototype.validate = function () {\n    return this.card.validate();\n  };\n\n  ShowCardAction.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.card.parse(json[\"card\"], errors);\n  };\n\n  ShowCardAction.prototype.setParent = function (value) {\n    _super.prototype.setParent.call(this, value);\n\n    this.card.setParent(value);\n  };\n\n  ShowCardAction.prototype.getAllInputs = function () {\n    return this.card.getAllInputs();\n  };\n\n  ShowCardAction.prototype.getResourceInformation = function () {\n    return _super.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation());\n  };\n\n  ShowCardAction.prototype.getActionById = function (id) {\n    var result = _super.prototype.getActionById.call(this, id);\n\n    if (!result) {\n      result = this.card.getActionById(id);\n    }\n\n    return result;\n  };\n\n  return ShowCardAction;\n}(Action);\n\nexports.ShowCardAction = ShowCardAction;\n\nvar ActionCollection =\n/** @class */\nfunction () {\n  function ActionCollection(owner) {\n    this._expandedAction = null;\n    this._renderedActionCount = 0;\n    this._statusCard = null;\n    this._actionCard = null;\n    this.items = [];\n    this.buttons = [];\n    this._owner = owner;\n  }\n\n  ActionCollection.prototype.refreshContainer = function () {\n    this._actionCardContainer.innerHTML = \"\";\n\n    if (this._actionCard === null && this._statusCard === null) {\n      this._actionCardContainer.style.padding = \"0px\";\n      this._actionCardContainer.style.marginTop = \"0px\";\n      return;\n    }\n\n    this._actionCardContainer.style.marginTop = this._renderedActionCount > 0 ? this._owner.hostConfig.actions.showCard.inlineTopMargin + \"px\" : \"0px\";\n\n    var padding = this._owner.getNonZeroPadding().toSpacingDefinition(this._owner.hostConfig);\n\n    if (this._actionCard !== null) {\n      this._actionCard.style.paddingLeft = padding.left + \"px\";\n      this._actionCard.style.paddingRight = padding.right + \"px\";\n      this._actionCard.style.marginLeft = \"-\" + padding.left + \"px\";\n      this._actionCard.style.marginRight = \"-\" + padding.right + \"px\";\n      Utils.appendChild(this._actionCardContainer, this._actionCard);\n    }\n\n    if (this._statusCard !== null) {\n      this._statusCard.style.paddingLeft = padding.left + \"px\";\n      this._statusCard.style.paddingRight = padding.right + \"px\";\n      this._statusCard.style.marginLeft = \"-\" + padding.left + \"px\";\n      this._statusCard.style.marginRight = \"-\" + padding.right + \"px\";\n      Utils.appendChild(this._actionCardContainer, this._statusCard);\n    }\n  };\n\n  ActionCollection.prototype.layoutChanged = function () {\n    this._owner.getRootElement().updateLayout();\n  };\n\n  ActionCollection.prototype.hideActionCard = function () {\n    var previouslyExpandedAction = this._expandedAction;\n    this._expandedAction = null;\n    this._actionCard = null;\n    this.refreshContainer();\n\n    if (previouslyExpandedAction) {\n      this.layoutChanged();\n      raiseInlineCardExpandedEvent(previouslyExpandedAction, false);\n    }\n  };\n\n  ActionCollection.prototype.showActionCard = function (action, suppressStyle, raiseEvent) {\n    if (suppressStyle === void 0) {\n      suppressStyle = false;\n    }\n\n    if (raiseEvent === void 0) {\n      raiseEvent = true;\n    }\n\n    if (action.card == null) {\n      return;\n    }\n\n    action.card.suppressStyle = suppressStyle;\n    var renderedCard = action.card.render();\n    this._actionCard = renderedCard;\n    this._expandedAction = action;\n    this.refreshContainer();\n\n    if (raiseEvent) {\n      this.layoutChanged();\n      raiseInlineCardExpandedEvent(action, true);\n    }\n  };\n\n  ActionCollection.prototype.collapseExpandedAction = function () {\n    for (var i = 0; i < this.buttons.length; i++) {\n      this.buttons[i].state = ActionButtonState.Normal;\n    }\n\n    this.hideActionCard();\n  };\n\n  ActionCollection.prototype.expandShowCardAction = function (action, raiseEvent) {\n    for (var i = 0; i < this.buttons.length; i++) {\n      if (this.buttons[i].action !== action) {\n        this.buttons[i].state = ActionButtonState.Subdued;\n      } else {\n        this.buttons[i].state = ActionButtonState.Expanded;\n      }\n    }\n\n    this.showActionCard(action, !(this._owner.isAtTheVeryLeft() && this._owner.isAtTheVeryRight()), raiseEvent);\n  };\n\n  ActionCollection.prototype.actionClicked = function (actionButton) {\n    if (!(actionButton.action instanceof ShowCardAction)) {\n      for (var i = 0; i < this.buttons.length; i++) {\n        this.buttons[i].state = ActionButtonState.Normal;\n      }\n\n      this.hideStatusCard();\n      this.hideActionCard();\n      actionButton.action.execute();\n    } else {\n      this.hideStatusCard();\n\n      if (this._owner.hostConfig.actions.showCard.actionMode === Enums.ShowCardActionMode.Popup) {\n        actionButton.action.execute();\n      } else if (actionButton.action === this._expandedAction) {\n        this.collapseExpandedAction();\n      } else {\n        this.expandShowCardAction(actionButton.action, true);\n      }\n    }\n  };\n\n  ActionCollection.prototype.getParentContainer = function () {\n    if (this._owner instanceof Container) {\n      return this._owner;\n    } else {\n      return this._owner.getParentContainer();\n    }\n  };\n\n  ActionCollection.prototype.findActionButton = function (action) {\n    for (var _i = 0, _a = this.buttons; _i < _a.length; _i++) {\n      var actionButton = _a[_i];\n\n      if (actionButton.action == action) {\n        return actionButton;\n      }\n    }\n\n    return null;\n  };\n\n  ActionCollection.prototype.parse = function (json, errors) {\n    this.clear();\n\n    if (json && json instanceof Array) {\n      for (var _i = 0, json_1 = json; _i < json_1.length; _i++) {\n        var jsonAction = json_1[_i];\n        var action = createActionInstance(this._owner, jsonAction, errors);\n\n        if (action) {\n          this.addAction(action);\n        }\n      }\n    }\n  };\n\n  ActionCollection.prototype.toJSON = function () {\n    if (this.items.length > 0) {\n      var result = [];\n\n      for (var _i = 0, _a = this.items; _i < _a.length; _i++) {\n        var action = _a[_i];\n        result.push(action.toJSON());\n      }\n\n      return result;\n    } else {\n      return null;\n    }\n  };\n\n  ActionCollection.prototype.showStatusCard = function (status) {\n    status.setParent(this._owner);\n    this._statusCard = status.render();\n    this.refreshContainer();\n  };\n\n  ActionCollection.prototype.hideStatusCard = function () {\n    this._statusCard = null;\n    this.refreshContainer();\n  };\n\n  ActionCollection.prototype.getActionById = function (id) {\n    var result = null;\n\n    for (var i = 0; i < this.items.length; i++) {\n      result = this.items[i].getActionById(id);\n\n      if (result) {\n        break;\n      }\n    }\n\n    return result;\n  };\n\n  ActionCollection.prototype.validate = function () {\n    var result = [];\n\n    if (this._owner.hostConfig.actions.maxActions && this.items.length > this._owner.hostConfig.actions.maxActions) {\n      result.push({\n        error: Enums.ValidationError.TooManyActions,\n        message: \"A maximum of \" + this._owner.hostConfig.actions.maxActions + \" actions are allowed.\"\n      });\n    }\n\n    if (this.items.length > 0 && !this._owner.hostConfig.supportsInteractivity) {\n      result.push({\n        error: Enums.ValidationError.InteractivityNotAllowed,\n        message: \"Interactivity is not allowed.\"\n      });\n    }\n\n    for (var i = 0; i < this.items.length; i++) {\n      if (!isActionAllowed(this.items[i], this._owner.getForbiddenActionTypes())) {\n        result.push({\n          error: Enums.ValidationError.ActionTypeNotAllowed,\n          message: \"Actions of type \" + this.items[i].getJsonTypeName() + \" are not allowe.\"\n        });\n      }\n    }\n\n    for (var i = 0; i < this.items.length; i++) {\n      result = result.concat(this.items[i].validate());\n    }\n\n    return result;\n  };\n\n  ActionCollection.prototype.render = function (orientation, isDesignMode) {\n    var _this = this;\n\n    if (!this._owner.hostConfig.supportsInteractivity) {\n      return null;\n    }\n\n    var element = document.createElement(\"div\");\n    var maxActions = this._owner.hostConfig.actions.maxActions ? Math.min(this._owner.hostConfig.actions.maxActions, this.items.length) : this.items.length;\n\n    var forbiddenActionTypes = this._owner.getForbiddenActionTypes();\n\n    this._actionCardContainer = document.createElement(\"div\");\n    this._renderedActionCount = 0;\n\n    if (this._owner.hostConfig.actions.preExpandSingleShowCardAction && maxActions == 1 && this.items[0] instanceof ShowCardAction && isActionAllowed(this.items[0], forbiddenActionTypes)) {\n      this.showActionCard(this.items[0], true);\n      this._renderedActionCount = 1;\n    } else {\n      var buttonStrip = document.createElement(\"div\");\n      buttonStrip.className = this._owner.hostConfig.makeCssClassName(\"ac-actionSet\");\n      buttonStrip.style.display = \"flex\";\n\n      if (orientation == Enums.Orientation.Horizontal) {\n        buttonStrip.style.flexDirection = \"row\";\n\n        if (this._owner.horizontalAlignment && this._owner.hostConfig.actions.actionAlignment != Enums.ActionAlignment.Stretch) {\n          switch (this._owner.horizontalAlignment) {\n            case Enums.HorizontalAlignment.Center:\n              buttonStrip.style.justifyContent = \"center\";\n              break;\n\n            case Enums.HorizontalAlignment.Right:\n              buttonStrip.style.justifyContent = \"flex-end\";\n              break;\n\n            default:\n              buttonStrip.style.justifyContent = \"flex-start\";\n              break;\n          }\n        } else {\n          switch (this._owner.hostConfig.actions.actionAlignment) {\n            case Enums.ActionAlignment.Center:\n              buttonStrip.style.justifyContent = \"center\";\n              break;\n\n            case Enums.ActionAlignment.Right:\n              buttonStrip.style.justifyContent = \"flex-end\";\n              break;\n\n            default:\n              buttonStrip.style.justifyContent = \"flex-start\";\n              break;\n          }\n        }\n      } else {\n        buttonStrip.style.flexDirection = \"column\";\n\n        if (this._owner.horizontalAlignment && this._owner.hostConfig.actions.actionAlignment != Enums.ActionAlignment.Stretch) {\n          switch (this._owner.horizontalAlignment) {\n            case Enums.HorizontalAlignment.Center:\n              buttonStrip.style.alignItems = \"center\";\n              break;\n\n            case Enums.HorizontalAlignment.Right:\n              buttonStrip.style.alignItems = \"flex-end\";\n              break;\n\n            default:\n              buttonStrip.style.alignItems = \"flex-start\";\n              break;\n          }\n        } else {\n          switch (this._owner.hostConfig.actions.actionAlignment) {\n            case Enums.ActionAlignment.Center:\n              buttonStrip.style.alignItems = \"center\";\n              break;\n\n            case Enums.ActionAlignment.Right:\n              buttonStrip.style.alignItems = \"flex-end\";\n              break;\n\n            case Enums.ActionAlignment.Stretch:\n              buttonStrip.style.alignItems = \"stretch\";\n              break;\n\n            default:\n              buttonStrip.style.alignItems = \"flex-start\";\n              break;\n          }\n        }\n      }\n\n      var parentContainerStyle = this.getParentContainer().style;\n\n      for (var i = 0; i < this.items.length; i++) {\n        if (isActionAllowed(this.items[i], forbiddenActionTypes)) {\n          var actionButton = this.findActionButton(this.items[i]);\n\n          if (!actionButton) {\n            actionButton = new ActionButton(this.items[i], parentContainerStyle);\n\n            actionButton.onClick = function (ab) {\n              _this.actionClicked(ab);\n            };\n\n            this.buttons.push(actionButton);\n          }\n\n          actionButton.render(this._owner.hostConfig.actions.actionAlignment);\n          buttonStrip.appendChild(actionButton.action.renderedElement);\n          this._renderedActionCount++;\n\n          if (this._renderedActionCount >= this._owner.hostConfig.actions.maxActions || i == this.items.length - 1) {\n            break;\n          } else if (this._owner.hostConfig.actions.buttonSpacing > 0) {\n            var spacer = document.createElement(\"div\");\n\n            if (orientation === Enums.Orientation.Horizontal) {\n              spacer.style.flex = \"0 0 auto\";\n              spacer.style.width = this._owner.hostConfig.actions.buttonSpacing + \"px\";\n            } else {\n              spacer.style.height = this._owner.hostConfig.actions.buttonSpacing + \"px\";\n            }\n\n            Utils.appendChild(buttonStrip, spacer);\n          }\n        }\n      }\n\n      var buttonStripContainer = document.createElement(\"div\");\n      buttonStripContainer.style.overflow = \"hidden\";\n      buttonStripContainer.appendChild(buttonStrip);\n      Utils.appendChild(element, buttonStripContainer);\n    }\n\n    Utils.appendChild(element, this._actionCardContainer);\n\n    for (var i = 0; i < this.buttons.length; i++) {\n      if (this.buttons[i].state == ActionButtonState.Expanded) {\n        this.expandShowCardAction(this.buttons[i].action, false);\n        break;\n      }\n    }\n\n    return this._renderedActionCount > 0 ? element : null;\n  };\n\n  ActionCollection.prototype.addAction = function (action) {\n    if (!action) {\n      throw new Error(\"The action parameter cannot be null.\");\n    }\n\n    if ((!action.parent || action.parent === this._owner) && this.items.indexOf(action) < 0) {\n      this.items.push(action);\n\n      if (!action.parent) {\n        action.setParent(this._owner);\n      }\n\n      invokeSetCollection(action, this);\n    } else {\n      throw new Error(\"The action already belongs to another element.\");\n    }\n  };\n\n  ActionCollection.prototype.removeAction = function (action) {\n    if (this.expandedAction && this._expandedAction == action) {\n      this.collapseExpandedAction();\n    }\n\n    var actionIndex = this.items.indexOf(action);\n\n    if (actionIndex >= 0) {\n      this.items.splice(actionIndex, 1);\n      action.setParent(null);\n      invokeSetCollection(action, null);\n\n      for (var i = 0; i < this.buttons.length; i++) {\n        if (this.buttons[i].action == action) {\n          this.buttons.splice(i, 1);\n          break;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  ActionCollection.prototype.clear = function () {\n    this.items = [];\n    this.buttons = [];\n    this._expandedAction = null;\n    this._renderedActionCount = 0;\n  };\n\n  ActionCollection.prototype.getAllInputs = function () {\n    var result = [];\n\n    for (var i = 0; i < this.items.length; i++) {\n      var action = this.items[i];\n      result = result.concat(action.getAllInputs());\n    }\n\n    return result;\n  };\n\n  ActionCollection.prototype.getResourceInformation = function () {\n    var result = [];\n\n    for (var i = 0; i < this.items.length; i++) {\n      result = result.concat(this.items[i].getResourceInformation());\n    }\n\n    return result;\n  };\n\n  Object.defineProperty(ActionCollection.prototype, \"renderedActionCount\", {\n    get: function () {\n      return this._renderedActionCount;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ActionCollection.prototype, \"expandedAction\", {\n    get: function () {\n      return this._expandedAction;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ActionCollection;\n}();\n\nvar ActionSet =\n/** @class */\nfunction (_super) {\n  __extends(ActionSet, _super);\n\n  function ActionSet() {\n    var _this = _super.call(this) || this;\n\n    _this.orientation = null;\n    _this._actionCollection = new ActionCollection(_this);\n    return _this;\n  }\n\n  ActionSet.prototype.internalRender = function () {\n    return this._actionCollection.render(this.orientation ? this.orientation : this.hostConfig.actions.actionsOrientation, this.isDesignMode());\n  };\n\n  ActionSet.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setEnumProperty(Enums.Orientation, result, \"orientation\", this.orientation);\n    Utils.setProperty(result, \"actions\", this._actionCollection.toJSON());\n    return result;\n  };\n\n  ActionSet.prototype.isBleeding = function () {\n    return this._actionCollection.expandedAction ? true : false;\n  };\n\n  ActionSet.prototype.getJsonTypeName = function () {\n    return \"ActionSet\";\n  };\n\n  ActionSet.prototype.getActionCount = function () {\n    return this._actionCollection.items.length;\n  };\n\n  ActionSet.prototype.getActionAt = function (index) {\n    if (index >= 0 && index < this.getActionCount()) {\n      return this._actionCollection.items[index];\n    } else {\n      _super.prototype.getActionAt.call(this, index);\n    }\n  };\n\n  ActionSet.prototype.validate = function () {\n    return this._actionCollection.validate();\n  };\n\n  ActionSet.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    var jsonOrientation = json[\"orientation\"];\n\n    if (jsonOrientation) {\n      this.orientation = Utils.getEnumValueOrDefault(Enums.Orientation, jsonOrientation, Enums.Orientation.Horizontal);\n    }\n\n    this._actionCollection.parse(json[\"actions\"], errors);\n  };\n\n  ActionSet.prototype.addAction = function (action) {\n    this._actionCollection.addAction(action);\n  };\n\n  ActionSet.prototype.getAllInputs = function () {\n    return this._actionCollection.getAllInputs();\n  };\n\n  ActionSet.prototype.getResourceInformation = function () {\n    return this._actionCollection.getResourceInformation();\n  };\n\n  ActionSet.prototype.renderSpeech = function () {\n    // TODO: What's the right thing to do here?\n    return \"\";\n  };\n\n  Object.defineProperty(ActionSet.prototype, \"isInteractive\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ActionSet;\n}(CardElement);\n\nexports.ActionSet = ActionSet;\n\nvar BackgroundImage =\n/** @class */\nfunction () {\n  function BackgroundImage() {\n    this.mode = Enums.BackgroundImageMode.Stretch;\n    this.horizontalAlignment = Enums.HorizontalAlignment.Left;\n    this.verticalAlignment = Enums.VerticalAlignment.Top;\n  }\n\n  BackgroundImage.prototype.parse = function (json, errors) {\n    this.url = json[\"url\"];\n    this.mode = Utils.getEnumValueOrDefault(Enums.BackgroundImageMode, json[\"mode\"], this.mode);\n    this.horizontalAlignment = Utils.getEnumValueOrDefault(Enums.HorizontalAlignment, json[\"horizontalAlignment\"], this.horizontalAlignment);\n    this.verticalAlignment = Utils.getEnumValueOrDefault(Enums.VerticalAlignment, json[\"verticalAlignment\"], this.verticalAlignment);\n  };\n\n  BackgroundImage.prototype.apply = function (element) {\n    if (this.url) {\n      element.style.backgroundImage = \"url('\" + this.url + \"')\";\n\n      switch (this.mode) {\n        case Enums.BackgroundImageMode.Repeat:\n          element.style.backgroundRepeat = \"repeat\";\n          break;\n\n        case Enums.BackgroundImageMode.RepeatHorizontally:\n          element.style.backgroundRepeat = \"repeat-x\";\n          break;\n\n        case Enums.BackgroundImageMode.RepeatVertically:\n          element.style.backgroundRepeat = \"repeat-y\";\n          break;\n\n        case Enums.BackgroundImageMode.Stretch:\n        default:\n          element.style.backgroundRepeat = \"no-repeat\";\n          element.style.backgroundSize = \"cover\";\n          break;\n      }\n\n      switch (this.horizontalAlignment) {\n        case Enums.HorizontalAlignment.Center:\n          element.style.backgroundPositionX = \"center\";\n          break;\n\n        case Enums.HorizontalAlignment.Right:\n          element.style.backgroundPositionX = \"right\";\n          break;\n      }\n\n      switch (this.verticalAlignment) {\n        case Enums.VerticalAlignment.Center:\n          element.style.backgroundPositionY = \"center\";\n          break;\n\n        case Enums.VerticalAlignment.Bottom:\n          element.style.backgroundPositionY = \"bottom\";\n          break;\n      }\n    }\n  };\n\n  return BackgroundImage;\n}();\n\nexports.BackgroundImage = BackgroundImage;\n\nvar Container =\n/** @class */\nfunction (_super) {\n  __extends(Container, _super);\n\n  function Container() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._items = [];\n    _this._renderedItems = [];\n    _this._style = null;\n    _this.verticalContentAlignment = Enums.VerticalAlignment.Top;\n    _this.rtl = null;\n    return _this;\n  }\n\n  Container.prototype.isElementAllowed = function (element, forbiddenElementTypes) {\n    if (!this.hostConfig.supportsInteractivity && element.isInteractive) {\n      return false;\n    }\n\n    if (forbiddenElementTypes) {\n      for (var i = 0; i < forbiddenElementTypes.length; i++) {\n        if (element.getJsonTypeName() === forbiddenElementTypes[i]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  Container.prototype.insertItemAt = function (item, index, forceInsert) {\n    if (!item.parent || forceInsert) {\n      if (item.isStandalone) {\n        if (index < 0 || index >= this._items.length) {\n          this._items.push(item);\n        } else {\n          this._items.splice(index, 0, item);\n        }\n\n        item.setParent(this);\n      } else {\n        throw new Error(\"Elements of type \" + item.getJsonTypeName() + \" cannot be used as standalone elements.\");\n      }\n    } else {\n      throw new Error(\"The element already belongs to another container.\");\n    }\n  };\n\n  Object.defineProperty(Container.prototype, \"hasExplicitStyle\", {\n    get: function () {\n      return this._style != null;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Container.prototype.getItemsCollectionPropertyName = function () {\n    return \"items\";\n  };\n\n  Container.prototype.isLastElementBleeding = function () {\n    return this._renderedItems.length > 0 ? this._renderedItems[this._renderedItems.length - 1].isBleeding() : false;\n  };\n\n  Container.prototype.applyPadding = function () {\n    if (!this.renderedElement) {\n      return;\n    }\n\n    if (this.padding) {\n      var physicalPadding = this.padding.toSpacingDefinition(this.hostConfig);\n      this.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\n      this.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\n      this.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\n      this.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\n    } else if (this.hasBackground) {\n      var physicalMargin = new SpacingDefinition();\n      var physicalPadding = new SpacingDefinition();\n      var useAutoPadding = (this.parent ? this.parent.canContentBleed() : false) && AdaptiveCard.useAutomaticContainerBleeding;\n\n      if (useAutoPadding) {\n        var effectivePadding = this.getNonZeroPadding();\n        var effectiveMargin = new PaddingDefinition(effectivePadding.top, effectivePadding.right, effectivePadding.bottom, effectivePadding.left);\n\n        if (!this.isAtTheVeryTop()) {\n          effectivePadding.top = Enums.Spacing.None;\n          effectiveMargin.top = Enums.Spacing.None;\n        }\n\n        if (!this.isAtTheVeryBottom()) {\n          effectivePadding.bottom = Enums.Spacing.None;\n          effectiveMargin.bottom = Enums.Spacing.None;\n        }\n\n        if (!this.isAtTheVeryLeft()) {\n          effectivePadding.left = Enums.Spacing.None;\n          effectiveMargin.left = Enums.Spacing.None;\n        }\n\n        if (!this.isAtTheVeryRight()) {\n          effectivePadding.right = Enums.Spacing.None;\n          effectiveMargin.right = Enums.Spacing.None;\n        }\n\n        if (effectivePadding.left != Enums.Spacing.None || effectivePadding.right != Enums.Spacing.None) {\n          if (effectivePadding.left == Enums.Spacing.None) {\n            effectivePadding.left = effectivePadding.right;\n          }\n\n          if (effectivePadding.right == Enums.Spacing.None) {\n            effectivePadding.right = effectivePadding.left;\n          }\n        }\n\n        if (effectivePadding.top != Enums.Spacing.None || effectivePadding.bottom != Enums.Spacing.None) {\n          if (effectivePadding.top == Enums.Spacing.None) {\n            effectivePadding.top = effectivePadding.bottom;\n          }\n\n          if (effectivePadding.bottom == Enums.Spacing.None) {\n            effectivePadding.bottom = effectivePadding.top;\n          }\n        }\n\n        if (effectivePadding.top != Enums.Spacing.None || effectivePadding.right != Enums.Spacing.None || effectivePadding.bottom != Enums.Spacing.None || effectivePadding.left != Enums.Spacing.None) {\n          if (effectivePadding.top == Enums.Spacing.None) {\n            effectivePadding.top = Enums.Spacing.Default;\n          }\n\n          if (effectivePadding.right == Enums.Spacing.None) {\n            effectivePadding.right = Enums.Spacing.Default;\n          }\n\n          if (effectivePadding.bottom == Enums.Spacing.None) {\n            effectivePadding = Object.assign({}, effectivePadding, {\n              bottom: Enums.Spacing.Default\n            });\n          }\n\n          if (effectivePadding.left == Enums.Spacing.None) {\n            effectivePadding = Object.assign({}, effectivePadding, {\n              left: Enums.Spacing.Default\n            });\n          }\n        }\n\n        if (effectivePadding.top == Enums.Spacing.None && effectivePadding.right == Enums.Spacing.None && effectivePadding.bottom == Enums.Spacing.None && effectivePadding.left == Enums.Spacing.None) {\n          effectivePadding = new PaddingDefinition(Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding);\n        }\n\n        physicalMargin = effectiveMargin.toSpacingDefinition(this.hostConfig);\n        physicalPadding = effectivePadding.toSpacingDefinition(this.hostConfig);\n      } else {\n        physicalPadding = new PaddingDefinition(Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding).toSpacingDefinition(this.hostConfig);\n      }\n\n      this.renderedElement.style.marginTop = \"-\" + physicalMargin.top + \"px\";\n      this.renderedElement.style.marginRight = \"-\" + physicalMargin.right + \"px\";\n      this.renderedElement.style.marginBottom = \"-\" + physicalMargin.bottom + \"px\";\n      this.renderedElement.style.marginLeft = \"-\" + physicalMargin.left + \"px\";\n      this.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\n      this.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\n      this.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\n      this.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\n\n      if (this.separatorElement) {\n        if (this.separatorOrientation == Enums.Orientation.Horizontal) {\n          this.separatorElement.style.marginLeft = \"-\" + physicalMargin.left + \"px\";\n          this.separatorElement.style.marginRight = \"-\" + physicalMargin.right + \"px\";\n        } else {\n          this.separatorElement.style.marginTop = \"-\" + physicalMargin.top + \"px\";\n          this.separatorElement.style.marginBottom = \"-\" + physicalMargin.bottom + \"px\";\n        }\n      }\n    }\n\n    if (this.isLastElementBleeding()) {\n      this.renderedElement.style.paddingBottom = \"0px\";\n    }\n  };\n\n  Container.prototype.internalRender = function () {\n    var _this = this;\n\n    this._renderedItems = []; // Cache hostConfig to avoid walking the parent hierarchy several times\n\n    var hostConfig = this.hostConfig;\n    var element = document.createElement(\"div\");\n\n    if (this.rtl != null && this.rtl) {\n      element.dir = \"rtl\";\n    }\n\n    element.classList.add(hostConfig.makeCssClassName(\"ac-container\"));\n    element.style.display = \"flex\";\n    element.style.flexDirection = \"column\";\n\n    if (AdaptiveCard.useAdvancedCardBottomTruncation) {\n      // Forces the container to be at least as tall as its content.\n      //\n      // Fixes a quirk in Chrome where, for nested flex elements, the\n      // inner element's height would never exceed the outer element's\n      // height. This caused overflow truncation to break -- containers\n      // would always be measured as not overflowing, since their heights\n      // were constrained by their parents as opposed to truly reflecting\n      // the height of their content.\n      //\n      // See the \"Browser Rendering Notes\" section of this answer:\n      // https://stackoverflow.com/questions/36247140/why-doesnt-flex-item-shrink-past-content-size\n      element.style.minHeight = '-webkit-min-content';\n    }\n\n    switch (this.verticalContentAlignment) {\n      case Enums.VerticalAlignment.Center:\n        element.style.justifyContent = \"center\";\n        break;\n\n      case Enums.VerticalAlignment.Bottom:\n        element.style.justifyContent = \"flex-end\";\n        break;\n\n      default:\n        element.style.justifyContent = \"flex-start\";\n        break;\n    }\n\n    if (this.hasBackground) {\n      if (this.backgroundImage) {\n        this.backgroundImage.apply(element);\n      }\n\n      var styleDefinition = this.hostConfig.containerStyles.getStyleByName(this.style, this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));\n\n      if (!Utils.isNullOrEmpty(styleDefinition.backgroundColor)) {\n        element.style.backgroundColor = Utils.stringToCssColor(styleDefinition.backgroundColor);\n      }\n    }\n\n    if (this.selectAction && hostConfig.supportsInteractivity) {\n      element.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\n      element.tabIndex = 0;\n      element.setAttribute(\"role\", \"button\");\n      element.setAttribute(\"aria-label\", this.selectAction.title);\n\n      element.onclick = function (e) {\n        if (_this.selectAction != null) {\n          _this.selectAction.execute();\n\n          e.cancelBubble = true;\n        }\n      };\n\n      element.onkeypress = function (e) {\n        if (_this.selectAction != null) {\n          // Enter or space pressed\n          if (e.keyCode == 13 || e.keyCode == 32) {\n            _this.selectAction.execute();\n          }\n        }\n      };\n    }\n\n    if (this._items.length > 0) {\n      for (var i = 0; i < this._items.length; i++) {\n        var renderedElement = this.isElementAllowed(this._items[i], this.getForbiddenElementTypes()) ? this._items[i].render() : null;\n\n        if (renderedElement) {\n          if (this._renderedItems.length > 0 && this._items[i].separatorElement) {\n            this._items[i].separatorElement.style.flex = \"0 0 auto\";\n            Utils.appendChild(element, this._items[i].separatorElement);\n          }\n\n          Utils.appendChild(element, renderedElement);\n\n          this._renderedItems.push(this._items[i]);\n        }\n      }\n    } else {\n      if (this.isDesignMode()) {\n        var placeholderElement = this.createPlaceholderElement();\n        placeholderElement.style.width = \"100%\";\n        placeholderElement.style.height = \"100%\";\n        element.appendChild(placeholderElement);\n      }\n    }\n\n    return element;\n  };\n\n  Container.prototype.truncateOverflow = function (maxHeight) {\n    // Add 1 to account for rounding differences between browsers\n    var boundary = this.renderedElement.offsetTop + maxHeight + 1;\n\n    var handleElement = function (cardElement) {\n      var elt = cardElement.renderedElement;\n\n      if (elt) {\n        switch (Utils.getFitStatus(elt, boundary)) {\n          case Enums.ContainerFitStatus.FullyInContainer:\n            var sizeChanged = cardElement['resetOverflow'](); // If the element's size changed after resetting content,\n            // we have to check if it still fits fully in the card\n\n            if (sizeChanged) {\n              handleElement(cardElement);\n            }\n\n            break;\n\n          case Enums.ContainerFitStatus.Overflowing:\n            var maxHeight_1 = boundary - elt.offsetTop;\n            cardElement['handleOverflow'](maxHeight_1);\n            break;\n\n          case Enums.ContainerFitStatus.FullyOutOfContainer:\n            cardElement['handleOverflow'](0);\n            break;\n        }\n      }\n    };\n\n    for (var _i = 0, _a = this._items; _i < _a.length; _i++) {\n      var item = _a[_i];\n      handleElement(item);\n    }\n\n    return true;\n  };\n\n  Container.prototype.undoOverflowTruncation = function () {\n    for (var _i = 0, _a = this._items; _i < _a.length; _i++) {\n      var item = _a[_i];\n      item['resetOverflow']();\n    }\n  };\n\n  Object.defineProperty(Container.prototype, \"hasBackground\", {\n    get: function () {\n      var parentContainer = this.getParentContainer();\n      return this.backgroundImage != undefined || this.hasExplicitStyle && (parentContainer ? parentContainer.style != this.style : false);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Container.prototype, \"defaultStyle\", {\n    get: function () {\n      return Enums.ContainerStyle.Default;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Container.prototype, \"allowCustomStyle\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Container.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    if (this._selectAction) {\n      Utils.setProperty(result, \"selectAction\", this._selectAction.toJSON());\n    }\n\n    if (this.backgroundImage) {\n      Utils.setProperty(result, \"backgroundImage\", this.backgroundImage.url);\n    }\n\n    Utils.setProperty(result, \"style\", this.style, \"default\");\n    Utils.setEnumProperty(Enums.VerticalAlignment, result, \"verticalContentAlignment\", this.verticalContentAlignment, Enums.VerticalAlignment.Top);\n\n    if (this._items.length > 0) {\n      var elements = [];\n\n      for (var _i = 0, _a = this._items; _i < _a.length; _i++) {\n        var element = _a[_i];\n        elements.push(element.toJSON());\n      }\n\n      Utils.setProperty(result, this.getItemsCollectionPropertyName(), elements);\n    }\n\n    return result;\n  };\n\n  Container.prototype.getItemCount = function () {\n    return this._items.length;\n  };\n\n  Container.prototype.getItemAt = function (index) {\n    return this._items[index];\n  };\n\n  Container.prototype.getJsonTypeName = function () {\n    return \"Container\";\n  };\n\n  Container.prototype.isBleeding = function () {\n    return this.isLastElementBleeding();\n  };\n\n  Container.prototype.isFirstElement = function (element) {\n    for (var i = 0; i < this._items.length; i++) {\n      if (this._items[i].isVisible) {\n        return this._items[i] == element;\n      }\n    }\n\n    return false;\n  };\n\n  Container.prototype.isLastElement = function (element) {\n    for (var i = this._items.length - 1; i >= 0; i--) {\n      if (this._items[i].isVisible) {\n        return this._items[i] == element;\n      }\n    }\n\n    return false;\n  };\n\n  Container.prototype.isRtl = function () {\n    if (this.rtl != null) {\n      return this.rtl;\n    } else {\n      var parentContainer = this.getParentContainer();\n      return parentContainer ? parentContainer.isRtl() : false;\n    }\n  };\n\n  Container.prototype.validate = function () {\n    var result = [];\n\n    if (this._style) {\n      var styleDefinition = this.hostConfig.containerStyles.getStyleByName(this._style);\n\n      if (!styleDefinition) {\n        result.push({\n          error: Enums.ValidationError.InvalidPropertyValue,\n          message: \"Unknown container style: \" + this._style\n        });\n      }\n    }\n\n    for (var i = 0; i < this._items.length; i++) {\n      if (!this.hostConfig.supportsInteractivity && this._items[i].isInteractive) {\n        result.push({\n          error: Enums.ValidationError.InteractivityNotAllowed,\n          message: \"Interactivity is not allowed.\"\n        });\n      }\n\n      if (!this.isElementAllowed(this._items[i], this.getForbiddenElementTypes())) {\n        result.push({\n          error: Enums.ValidationError.InteractivityNotAllowed,\n          message: \"Elements of type \" + this._items[i].getJsonTypeName() + \" are not allowed in this container.\"\n        });\n      }\n\n      result = result.concat(this._items[i].validate());\n    }\n\n    return result;\n  };\n\n  Container.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.setShouldFallback(false);\n    this._items = [];\n    this._renderedItems = [];\n    var jsonBackgroundImage = json[\"backgroundImage\"];\n\n    if (jsonBackgroundImage) {\n      this.backgroundImage = new BackgroundImage();\n\n      if (typeof jsonBackgroundImage === \"string\") {\n        this.backgroundImage.url = jsonBackgroundImage;\n        this.backgroundImage.mode = Enums.BackgroundImageMode.Stretch;\n      } else if (typeof jsonBackgroundImage === \"object\") {\n        this.backgroundImage = new BackgroundImage();\n        this.backgroundImage.parse(json[\"backgroundImage\"], errors);\n      }\n    }\n\n    this.verticalContentAlignment = Utils.getEnumValueOrDefault(Enums.VerticalAlignment, json[\"verticalContentAlignment\"], this.verticalContentAlignment);\n    this._style = json[\"style\"];\n    this.selectAction = createActionInstance(this, json[\"selectAction\"], errors);\n\n    if (json[this.getItemsCollectionPropertyName()] != null) {\n      var items = json[this.getItemsCollectionPropertyName()];\n      this.clear();\n\n      for (var i = 0; i < items.length; i++) {\n        var element = createElementInstance(this, items[i], errors);\n\n        if (element) {\n          this.insertItemAt(element, -1, true);\n        }\n      }\n    }\n  };\n\n  Container.prototype.indexOf = function (cardElement) {\n    return this._items.indexOf(cardElement);\n  };\n\n  Container.prototype.addItem = function (item) {\n    this.insertItemAt(item, -1, false);\n  };\n\n  Container.prototype.insertItemBefore = function (item, insertBefore) {\n    this.insertItemAt(item, this._items.indexOf(insertBefore), false);\n  };\n\n  Container.prototype.insertItemAfter = function (item, insertAfter) {\n    this.insertItemAt(item, this._items.indexOf(insertAfter) + 1, false);\n  };\n\n  Container.prototype.removeItem = function (item) {\n    var itemIndex = this._items.indexOf(item);\n\n    if (itemIndex >= 0) {\n      this._items.splice(itemIndex, 1);\n\n      item.setParent(null);\n      this.updateLayout();\n      return true;\n    }\n\n    return false;\n  };\n\n  Container.prototype.clear = function () {\n    this._items = [];\n  };\n\n  Container.prototype.canContentBleed = function () {\n    return this.hasBackground ? false : _super.prototype.canContentBleed.call(this);\n  };\n\n  Container.prototype.getAllInputs = function () {\n    var result = [];\n\n    for (var i = 0; i < this._items.length; i++) {\n      var item = this._items[i];\n      result = result.concat(item.getAllInputs());\n    }\n\n    return result;\n  };\n\n  Container.prototype.getResourceInformation = function () {\n    var result = [];\n\n    if (this.backgroundImage && !Utils.isNullOrEmpty(this.backgroundImage.url)) {\n      result.push({\n        url: this.backgroundImage.url,\n        mimeType: \"image\"\n      });\n    }\n\n    for (var i = 0; i < this.getItemCount(); i++) {\n      result = result.concat(this.getItemAt(i).getResourceInformation());\n    }\n\n    return result;\n  };\n\n  Container.prototype.getElementById = function (id) {\n    var result = _super.prototype.getElementById.call(this, id);\n\n    if (!result) {\n      for (var i = 0; i < this._items.length; i++) {\n        result = this._items[i].getElementById(id);\n\n        if (result) {\n          break;\n        }\n      }\n    }\n\n    return result;\n  };\n\n  Container.prototype.getActionById = function (id) {\n    var result = _super.prototype.getActionById.call(this, id);\n\n    if (!result) {\n      if (this.selectAction) {\n        result = this.selectAction.getActionById(id);\n      }\n\n      if (!result) {\n        for (var i = 0; i < this._items.length; i++) {\n          result = this._items[i].getActionById(id);\n\n          if (result) {\n            break;\n          }\n        }\n      }\n    }\n\n    return result;\n  };\n\n  Container.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak;\n    } // render each item\n\n\n    var speak = null;\n\n    if (this._items.length > 0) {\n      speak = '';\n\n      for (var i = 0; i < this._items.length; i++) {\n        var result = this._items[i].renderSpeech();\n\n        if (result) {\n          speak += result;\n        }\n      }\n    }\n\n    return speak;\n  };\n\n  Container.prototype.updateLayout = function (processChildren) {\n    if (processChildren === void 0) {\n      processChildren = true;\n    }\n\n    _super.prototype.updateLayout.call(this, processChildren);\n\n    this.applyPadding();\n\n    if (processChildren) {\n      for (var i = 0; i < this._items.length; i++) {\n        this._items[i].updateLayout();\n      }\n    }\n  };\n\n  Object.defineProperty(Container.prototype, \"style\", {\n    get: function () {\n      if (this.allowCustomStyle) {\n        if (this._style && this.hostConfig.containerStyles.getStyleByName(this._style)) {\n          return this._style;\n        }\n\n        return null;\n      } else {\n        return this.defaultStyle;\n      }\n    },\n    set: function (value) {\n      this._style = value;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Container.prototype, \"padding\", {\n    get: function () {\n      return this.getPadding();\n    },\n    set: function (value) {\n      this.setPadding(value);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Container.prototype, \"selectAction\", {\n    get: function () {\n      return this._selectAction;\n    },\n    set: function (value) {\n      this._selectAction = value;\n\n      if (this._selectAction) {\n        this._selectAction.setParent(this);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Container;\n}(CardElementContainer);\n\nexports.Container = Container;\n\nvar Column =\n/** @class */\nfunction (_super) {\n  __extends(Column, _super);\n\n  function Column(width) {\n    if (width === void 0) {\n      width = \"auto\";\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this._computedWeight = 0;\n    _this.width = \"auto\";\n    _this.width = width;\n    return _this;\n  }\n\n  Column.prototype.adjustRenderedElementSize = function (renderedElement) {\n    if (this.isDesignMode()) {\n      renderedElement.style.minWidth = \"20px\";\n      renderedElement.style.minHeight = \"20px\";\n    } else {\n      renderedElement.style.minWidth = \"0\";\n    }\n\n    if (this.width === \"auto\") {\n      renderedElement.style.flex = \"0 1 auto\";\n    } else if (this.width === \"stretch\") {\n      renderedElement.style.flex = \"1 1 50px\";\n    } else {\n      var sizeAndUnit = this.width;\n\n      if (sizeAndUnit.unit == Enums.SizeUnit.Pixel) {\n        renderedElement.style.flex = \"0 0 auto\";\n        renderedElement.style.width = sizeAndUnit.physicalSize + \"px\";\n      } else {\n        renderedElement.style.flex = \"1 1 \" + (this._computedWeight > 0 ? this._computedWeight : sizeAndUnit.physicalSize) + \"%\";\n      }\n    }\n  };\n\n  Object.defineProperty(Column.prototype, \"separatorOrientation\", {\n    get: function () {\n      return Enums.Orientation.Vertical;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  Column.prototype.getJsonTypeName = function () {\n    return \"Column\";\n  };\n\n  Column.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    if (this.width instanceof Utils.SizeAndUnit) {\n      if (this.width.unit == Enums.SizeUnit.Pixel) {\n        Utils.setProperty(result, \"width\", this.width.physicalSize + \"px\");\n      } else {\n        Utils.setProperty(result, \"width\", this.width.physicalSize);\n      }\n    } else {\n      Utils.setProperty(result, \"width\", this.width);\n    }\n\n    return result;\n  };\n\n  Column.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    var jsonWidth = json[\"width\"];\n\n    if (jsonWidth === undefined) {\n      jsonWidth = json[\"size\"];\n\n      if (jsonWidth !== undefined) {\n        raiseParseError({\n          error: Enums.ValidationError.Deprecated,\n          message: \"The \\\"Column.size\\\" property is deprecated and will be removed. Use the \\\"Column.width\\\" property instead.\"\n        }, errors);\n      }\n    }\n\n    var invalidWidth = false;\n\n    try {\n      this.width = Utils.SizeAndUnit.parse(jsonWidth);\n    } catch (e) {\n      if (typeof jsonWidth === \"string\" && (jsonWidth === \"auto\" || jsonWidth === \"stretch\")) {\n        this.width = jsonWidth;\n      } else {\n        invalidWidth = true;\n      }\n    }\n\n    if (invalidWidth) {\n      raiseParseError({\n        error: Enums.ValidationError.InvalidPropertyValue,\n        message: \"Invalid column width:\" + jsonWidth + \" - defaulting to \\\"auto\\\"\"\n      }, errors);\n    }\n  };\n\n  Object.defineProperty(Column.prototype, \"hasVisibleSeparator\", {\n    get: function () {\n      if (this.parent && this.parent instanceof ColumnSet) {\n        return this.separatorElement && !this.parent.isLeftMostElement(this);\n      } else {\n        return false;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(Column.prototype, \"isStandalone\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return Column;\n}(Container);\n\nexports.Column = Column;\n\nvar ColumnSet =\n/** @class */\nfunction (_super) {\n  __extends(ColumnSet, _super);\n\n  function ColumnSet() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._columns = [];\n    return _this;\n  }\n\n  ColumnSet.prototype.applyPadding = function () {\n    if (this.padding) {\n      if (this.renderedElement) {\n        var physicalPadding = this.padding.toSpacingDefinition(this.hostConfig);\n        this.renderedElement.style.paddingTop = physicalPadding.top + \"px\";\n        this.renderedElement.style.paddingRight = physicalPadding.right + \"px\";\n        this.renderedElement.style.paddingBottom = physicalPadding.bottom + \"px\";\n        this.renderedElement.style.paddingLeft = physicalPadding.left + \"px\";\n      }\n    }\n  };\n\n  ColumnSet.prototype.internalRender = function () {\n    var _this = this;\n\n    if (this._columns.length > 0) {\n      // Cache hostConfig to avoid walking the parent hierarchy several times\n      var hostConfig = this.hostConfig;\n      var element = document.createElement(\"div\");\n      element.className = hostConfig.makeCssClassName(\"ac-columnSet\");\n      element.style.display = \"flex\";\n\n      if (AdaptiveCard.useAdvancedCardBottomTruncation) {\n        // See comment in Container.internalRender()\n        element.style.minHeight = '-webkit-min-content';\n      }\n\n      if (this.selectAction && hostConfig.supportsInteractivity) {\n        element.classList.add(hostConfig.makeCssClassName(\"ac-selectable\"));\n\n        element.onclick = function (e) {\n          _this.selectAction.execute();\n\n          e.cancelBubble = true;\n        };\n      }\n\n      switch (this.horizontalAlignment) {\n        case Enums.HorizontalAlignment.Center:\n          element.style.justifyContent = \"center\";\n          break;\n\n        case Enums.HorizontalAlignment.Right:\n          element.style.justifyContent = \"flex-end\";\n          break;\n\n        default:\n          element.style.justifyContent = \"flex-start\";\n          break;\n      }\n\n      var totalWeight = 0;\n\n      for (var _i = 0, _a = this._columns; _i < _a.length; _i++) {\n        var column = _a[_i];\n\n        if (column.width instanceof Utils.SizeAndUnit && column.width.unit == Enums.SizeUnit.Weight) {\n          totalWeight += column.width.physicalSize;\n        }\n      }\n\n      var renderedColumnCount = 0;\n\n      for (var _b = 0, _c = this._columns; _b < _c.length; _b++) {\n        var column = _c[_b];\n\n        if (column.width instanceof Utils.SizeAndUnit && column.width.unit == Enums.SizeUnit.Weight && totalWeight > 0) {\n          var computedWeight = 100 / totalWeight * column.width.physicalSize; // Best way to emulate \"internal\" access I know of\n\n          column[\"_computedWeight\"] = computedWeight;\n        }\n\n        var renderedColumn = column.render();\n\n        if (renderedColumn) {\n          if (renderedColumnCount > 0 && column.separatorElement) {\n            column.separatorElement.style.flex = \"0 0 auto\";\n            Utils.appendChild(element, column.separatorElement);\n          }\n\n          Utils.appendChild(element, renderedColumn);\n          renderedColumnCount++;\n        }\n      }\n\n      return renderedColumnCount > 0 ? element : null;\n    } else {\n      return null;\n    }\n  };\n\n  ColumnSet.prototype.truncateOverflow = function (maxHeight) {\n    for (var _i = 0, _a = this._columns; _i < _a.length; _i++) {\n      var column = _a[_i];\n      column['handleOverflow'](maxHeight);\n    }\n\n    return true;\n  };\n\n  ColumnSet.prototype.undoOverflowTruncation = function () {\n    for (var _i = 0, _a = this._columns; _i < _a.length; _i++) {\n      var column = _a[_i];\n      column['resetOverflow']();\n    }\n  };\n\n  ColumnSet.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    if (this._selectAction) {\n      Utils.setProperty(result, \"selectAction\", this.selectAction.toJSON());\n    }\n\n    if (this._columns.length > 0) {\n      var columns = [];\n\n      for (var _i = 0, _a = this._columns; _i < _a.length; _i++) {\n        var column = _a[_i];\n        columns.push(column.toJSON());\n      }\n\n      Utils.setProperty(result, \"columns\", columns);\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.isFirstElement = function (element) {\n    for (var i = 0; i < this._columns.length; i++) {\n      if (this._columns[i].isVisible) {\n        return this._columns[i] == element;\n      }\n    }\n\n    return false;\n  };\n\n  ColumnSet.prototype.getCount = function () {\n    return this._columns.length;\n  };\n\n  ColumnSet.prototype.getItemCount = function () {\n    return this.getCount();\n  };\n\n  ColumnSet.prototype.getColumnAt = function (index) {\n    return this._columns[index];\n  };\n\n  ColumnSet.prototype.getItemAt = function (index) {\n    return this.getColumnAt(index);\n  };\n\n  ColumnSet.prototype.getJsonTypeName = function () {\n    return \"ColumnSet\";\n  };\n\n  ColumnSet.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this.selectAction = createActionInstance(this, json[\"selectAction\"], errors);\n\n    if (json[\"columns\"] != null) {\n      var jsonColumns = json[\"columns\"];\n      this._columns = [];\n\n      for (var i = 0; i < jsonColumns.length; i++) {\n        var column = new Column();\n        column.setParent(this);\n        column.parse(jsonColumns[i], errors);\n\n        this._columns.push(column);\n      }\n    }\n  };\n\n  ColumnSet.prototype.validate = function () {\n    var result = [];\n    var weightedColumns = 0;\n    var stretchedColumns = 0;\n\n    for (var i = 0; i < this._columns.length; i++) {\n      if (typeof this._columns[i].width === \"number\") {\n        weightedColumns++;\n      } else if (this._columns[i].width === \"stretch\") {\n        stretchedColumns++;\n      }\n\n      result = result.concat(this._columns[i].validate());\n    }\n\n    if (weightedColumns > 0 && stretchedColumns > 0) {\n      result.push({\n        error: Enums.ValidationError.Hint,\n        message: \"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space.\"\n      });\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.updateLayout = function (processChildren) {\n    if (processChildren === void 0) {\n      processChildren = true;\n    }\n\n    _super.prototype.updateLayout.call(this, processChildren);\n\n    this.applyPadding();\n\n    if (processChildren) {\n      for (var i = 0; i < this._columns.length; i++) {\n        this._columns[i].updateLayout();\n      }\n    }\n  };\n\n  ColumnSet.prototype.addColumn = function (column) {\n    if (!column.parent) {\n      this._columns.push(column);\n\n      column.setParent(this);\n    } else {\n      throw new Error(\"This column already belongs to another ColumnSet.\");\n    }\n  };\n\n  ColumnSet.prototype.removeItem = function (item) {\n    if (item instanceof Column) {\n      var itemIndex = this._columns.indexOf(item);\n\n      if (itemIndex >= 0) {\n        this._columns.splice(itemIndex, 1);\n\n        item.setParent(null);\n        this.updateLayout();\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  ColumnSet.prototype.indexOf = function (cardElement) {\n    return cardElement instanceof Column ? this._columns.indexOf(cardElement) : -1;\n  };\n\n  ColumnSet.prototype.isLeftMostElement = function (element) {\n    return this._columns.indexOf(element) == 0;\n  };\n\n  ColumnSet.prototype.isRightMostElement = function (element) {\n    return this._columns.indexOf(element) == this._columns.length - 1;\n  };\n\n  ColumnSet.prototype.getAllInputs = function () {\n    var result = [];\n\n    for (var i = 0; i < this._columns.length; i++) {\n      result = result.concat(this._columns[i].getAllInputs());\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.getResourceInformation = function () {\n    var result = [];\n\n    for (var i = 0; i < this._columns.length; i++) {\n      result = result.concat(this._columns[i].getResourceInformation());\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.getElementById = function (id) {\n    var result = _super.prototype.getElementById.call(this, id);\n\n    if (!result) {\n      for (var i = 0; i < this._columns.length; i++) {\n        result = this._columns[i].getElementById(id);\n\n        if (result) {\n          break;\n        }\n      }\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.getActionById = function (id) {\n    var result = null;\n\n    for (var i = 0; i < this._columns.length; i++) {\n      result = this._columns[i].getActionById(id);\n\n      if (result) {\n        break;\n      }\n    }\n\n    return result;\n  };\n\n  ColumnSet.prototype.renderSpeech = function () {\n    if (this.speak != null) {\n      return this.speak;\n    } // render each item\n\n\n    var speak = '';\n\n    if (this._columns.length > 0) {\n      for (var i = 0; i < this._columns.length; i++) {\n        speak += this._columns[i].renderSpeech();\n      }\n    }\n\n    return speak;\n  };\n\n  Object.defineProperty(ColumnSet.prototype, \"padding\", {\n    get: function () {\n      return this.getPadding();\n    },\n    set: function (value) {\n      this.setPadding(value);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(ColumnSet.prototype, \"selectAction\", {\n    get: function () {\n      return this._selectAction;\n    },\n    set: function (value) {\n      this._selectAction = value;\n\n      if (this._selectAction) {\n        this._selectAction.setParent(this);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ColumnSet;\n}(CardElementContainer);\n\nexports.ColumnSet = ColumnSet;\n\nfunction raiseImageLoadedEvent(image) {\n  var card = image.getRootElement();\n  var onImageLoadedHandler = card && card.onImageLoaded ? card.onImageLoaded : AdaptiveCard.onImageLoaded;\n\n  if (onImageLoadedHandler) {\n    onImageLoadedHandler(image);\n  }\n}\n\nfunction raiseAnchorClickedEvent(element, anchor) {\n  var card = element.getRootElement();\n  var onAnchorClickedHandler = card && card.onAnchorClicked ? card.onAnchorClicked : AdaptiveCard.onAnchorClicked;\n  return onAnchorClickedHandler != null ? onAnchorClickedHandler(element, anchor) : false;\n}\n\nfunction raiseExecuteActionEvent(action) {\n  var card = action.parent.getRootElement();\n  var onExecuteActionHandler = card && card.onExecuteAction ? card.onExecuteAction : AdaptiveCard.onExecuteAction;\n\n  if (onExecuteActionHandler) {\n    action.prepare(action.parent.getRootElement().getAllInputs());\n    onExecuteActionHandler(action);\n  }\n}\n\nfunction raiseInlineCardExpandedEvent(action, isExpanded) {\n  var card = action.parent.getRootElement();\n  var onInlineCardExpandedHandler = card && card.onInlineCardExpanded ? card.onInlineCardExpanded : AdaptiveCard.onInlineCardExpanded;\n\n  if (onInlineCardExpandedHandler) {\n    onInlineCardExpandedHandler(action, isExpanded);\n  }\n}\n\nfunction raiseElementVisibilityChangedEvent(element, shouldUpdateLayout) {\n  if (shouldUpdateLayout === void 0) {\n    shouldUpdateLayout = true;\n  }\n\n  var rootElement = element.getRootElement();\n\n  if (shouldUpdateLayout) {\n    rootElement.updateLayout();\n  }\n\n  var card = rootElement;\n  var onElementVisibilityChangedHandler = card && card.onElementVisibilityChanged ? card.onElementVisibilityChanged : AdaptiveCard.onElementVisibilityChanged;\n\n  if (onElementVisibilityChangedHandler != null) {\n    onElementVisibilityChangedHandler(element);\n  }\n}\n\nfunction raiseParseElementEvent(element, json, errors) {\n  var card = element.getRootElement();\n  var onParseElementHandler = card && card.onParseElement ? card.onParseElement : AdaptiveCard.onParseElement;\n\n  if (onParseElementHandler != null) {\n    onParseElementHandler(element, json, errors);\n  }\n}\n\nfunction raiseParseActionEvent(action, json, errors) {\n  var card = action.parent ? action.parent.getRootElement() : null;\n  var onParseActionHandler = card && card.onParseAction ? card.onParseAction : AdaptiveCard.onParseAction;\n\n  if (onParseActionHandler != null) {\n    onParseActionHandler(action, json, errors);\n  }\n}\n\nfunction raiseParseError(error, errors) {\n  if (errors) {\n    errors.push(error);\n  }\n\n  if (AdaptiveCard.onParseError != null) {\n    AdaptiveCard.onParseError(error);\n  }\n}\n\nvar ContainerWithActions =\n/** @class */\nfunction (_super) {\n  __extends(ContainerWithActions, _super);\n\n  function ContainerWithActions() {\n    var _this = _super.call(this) || this;\n\n    _this._actionCollection = new ActionCollection(_this);\n    return _this;\n  }\n\n  Object.defineProperty(ContainerWithActions.prototype, \"renderIfEmpty\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  ContainerWithActions.prototype.internalRender = function () {\n    var element = _super.prototype.internalRender.call(this);\n\n    var renderedActions = this._actionCollection.render(this.hostConfig.actions.actionsOrientation, false);\n\n    if (renderedActions) {\n      Utils.appendChild(element, Utils.renderSeparation({\n        spacing: this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing),\n        lineThickness: null,\n        lineColor: null\n      }, Enums.Orientation.Horizontal));\n      Utils.appendChild(element, renderedActions);\n    }\n\n    if (this.renderIfEmpty) {\n      return element;\n    } else {\n      return element.children.length > 0 ? element : null;\n    }\n  };\n\n  ContainerWithActions.prototype.isLastElementBleeding = function () {\n    if (this._actionCollection.renderedActionCount == 0) {\n      return _super.prototype.isLastElementBleeding.call(this) ? !this.isDesignMode() : false;\n    } else {\n      if (this._actionCollection.items.length == 1) {\n        return this._actionCollection.expandedAction != null && !this.hostConfig.actions.preExpandSingleShowCardAction;\n      } else {\n        return this._actionCollection.expandedAction != null;\n      }\n    }\n  };\n\n  ContainerWithActions.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"actions\", this._actionCollection.toJSON());\n    return result;\n  };\n\n  ContainerWithActions.prototype.getActionCount = function () {\n    return this._actionCollection.items.length;\n  };\n\n  ContainerWithActions.prototype.getActionAt = function (index) {\n    if (index >= 0 && index < this.getActionCount()) {\n      return this._actionCollection.items[index];\n    } else {\n      _super.prototype.getActionAt.call(this, index);\n    }\n  };\n\n  ContainerWithActions.prototype.getActionById = function (id) {\n    var result = this._actionCollection.getActionById(id);\n\n    return result ? result : _super.prototype.getActionById.call(this, id);\n  };\n\n  ContainerWithActions.prototype.parse = function (json, errors) {\n    _super.prototype.parse.call(this, json, errors);\n\n    this._actionCollection.parse(json[\"actions\"]);\n  };\n\n  ContainerWithActions.prototype.validate = function () {\n    var result = _super.prototype.validate.call(this);\n\n    if (this._actionCollection) {\n      result = result.concat(this._actionCollection.validate());\n    }\n\n    return result;\n  };\n\n  ContainerWithActions.prototype.isLastElement = function (element) {\n    return _super.prototype.isLastElement.call(this, element) && this._actionCollection.items.length == 0;\n  };\n\n  ContainerWithActions.prototype.addAction = function (action) {\n    this._actionCollection.addAction(action);\n  };\n\n  ContainerWithActions.prototype.clear = function () {\n    _super.prototype.clear.call(this);\n\n    this._actionCollection.clear();\n  };\n\n  ContainerWithActions.prototype.getAllInputs = function () {\n    return _super.prototype.getAllInputs.call(this).concat(this._actionCollection.getAllInputs());\n  };\n\n  ContainerWithActions.prototype.getResourceInformation = function () {\n    return _super.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation());\n  };\n\n  Object.defineProperty(ContainerWithActions.prototype, \"isStandalone\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  return ContainerWithActions;\n}(Container);\n\nexports.ContainerWithActions = ContainerWithActions;\n\nvar TypeRegistry =\n/** @class */\nfunction () {\n  function TypeRegistry() {\n    this._items = [];\n    this.reset();\n  }\n\n  TypeRegistry.prototype.findTypeRegistration = function (typeName) {\n    for (var i = 0; i < this._items.length; i++) {\n      if (this._items[i].typeName === typeName) {\n        return this._items[i];\n      }\n    }\n\n    return null;\n  };\n\n  TypeRegistry.prototype.clear = function () {\n    this._items = [];\n  };\n\n  TypeRegistry.prototype.registerType = function (typeName, createInstance) {\n    var registrationInfo = this.findTypeRegistration(typeName);\n\n    if (registrationInfo != null) {\n      registrationInfo.createInstance = createInstance;\n    } else {\n      registrationInfo = {\n        typeName: typeName,\n        createInstance: createInstance\n      };\n\n      this._items.push(registrationInfo);\n    }\n  };\n\n  TypeRegistry.prototype.unregisterType = function (typeName) {\n    for (var i = 0; i < this._items.length; i++) {\n      if (this._items[i].typeName === typeName) {\n        this._items.splice(i, 1);\n\n        return;\n      }\n    }\n  };\n\n  TypeRegistry.prototype.createInstance = function (typeName) {\n    var registrationInfo = this.findTypeRegistration(typeName);\n    return registrationInfo ? registrationInfo.createInstance() : null;\n  };\n\n  TypeRegistry.prototype.getItemCount = function () {\n    return this._items.length;\n  };\n\n  TypeRegistry.prototype.getItemAt = function (index) {\n    return this._items[index];\n  };\n\n  return TypeRegistry;\n}();\n\nexports.TypeRegistry = TypeRegistry;\n\nvar ElementTypeRegistry =\n/** @class */\nfunction (_super) {\n  __extends(ElementTypeRegistry, _super);\n\n  function ElementTypeRegistry() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  ElementTypeRegistry.prototype.reset = function () {\n    this.clear();\n    this.registerType(\"Container\", function () {\n      return new Container();\n    });\n    this.registerType(\"TextBlock\", function () {\n      return new TextBlock();\n    });\n    this.registerType(\"Image\", function () {\n      return new Image();\n    });\n    this.registerType(\"ImageSet\", function () {\n      return new ImageSet();\n    });\n    this.registerType(\"Media\", function () {\n      return new Media();\n    });\n    this.registerType(\"FactSet\", function () {\n      return new FactSet();\n    });\n    this.registerType(\"ColumnSet\", function () {\n      return new ColumnSet();\n    });\n    this.registerType(\"Input.Text\", function () {\n      return new TextInput();\n    });\n    this.registerType(\"Input.Date\", function () {\n      return new DateInput();\n    });\n    this.registerType(\"Input.Time\", function () {\n      return new TimeInput();\n    });\n    this.registerType(\"Input.Number\", function () {\n      return new NumberInput();\n    });\n    this.registerType(\"Input.ChoiceSet\", function () {\n      return new ChoiceSetInput();\n    });\n    this.registerType(\"Input.Toggle\", function () {\n      return new ToggleInput();\n    });\n  };\n\n  return ElementTypeRegistry;\n}(TypeRegistry);\n\nexports.ElementTypeRegistry = ElementTypeRegistry;\n\nvar ActionTypeRegistry =\n/** @class */\nfunction (_super) {\n  __extends(ActionTypeRegistry, _super);\n\n  function ActionTypeRegistry() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  ActionTypeRegistry.prototype.reset = function () {\n    this.clear();\n    this.registerType(\"Action.OpenUrl\", function () {\n      return new OpenUrlAction();\n    });\n    this.registerType(\"Action.Submit\", function () {\n      return new SubmitAction();\n    });\n    this.registerType(\"Action.ShowCard\", function () {\n      return new ShowCardAction();\n    });\n  };\n\n  return ActionTypeRegistry;\n}(TypeRegistry);\n\nexports.ActionTypeRegistry = ActionTypeRegistry;\n\nvar AdaptiveCard =\n/** @class */\nfunction (_super) {\n  __extends(AdaptiveCard, _super);\n\n  function AdaptiveCard() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._cardTypeName = \"AdaptiveCard\";\n    _this._fallbackCard = null;\n    _this.onAnchorClicked = null;\n    _this.onExecuteAction = null;\n    _this.onElementVisibilityChanged = null;\n    _this.onImageLoaded = null;\n    _this.onInlineCardExpanded = null;\n    _this.onParseElement = null;\n    _this.onParseAction = null;\n    _this.version = new HostConfig.Version(1, 0);\n    _this.designMode = false;\n    return _this;\n  }\n\n  Object.defineProperty(AdaptiveCard, \"processMarkdown\", {\n    get: function () {\n      throw new Error(\"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.\");\n    },\n    set: function (value) {\n      throw new Error(\"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead.\");\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  AdaptiveCard.applyMarkdown = function (text) {\n    var result = {\n      didProcess: false\n    };\n\n    if (AdaptiveCard.onProcessMarkdown) {\n      AdaptiveCard.onProcessMarkdown(text, result);\n    } else if (window[\"markdownit\"]) {\n      // Check for markdownit\n      result.outputHtml = window[\"markdownit\"]().render(text);\n      result.didProcess = true;\n    } else {\n      console.warn(\"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown\");\n    }\n\n    return result;\n  };\n\n  AdaptiveCard.prototype.isVersionSupported = function () {\n    if (this.bypassVersionCheck) {\n      return true;\n    } else {\n      var unsupportedVersion = !this.version || !this.version.isValid || AdaptiveCard.currentVersion.major < this.version.major || AdaptiveCard.currentVersion.major == this.version.major && AdaptiveCard.currentVersion.minor < this.version.minor;\n      return !unsupportedVersion;\n    }\n  };\n\n  Object.defineProperty(AdaptiveCard.prototype, \"renderIfEmpty\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  AdaptiveCard.prototype.getItemsCollectionPropertyName = function () {\n    return \"body\";\n  };\n\n  AdaptiveCard.prototype.applyPadding = function () {\n    if (!this.renderedElement) {\n      return;\n    }\n\n    var effectivePadding = this.padding ? this.padding.toSpacingDefinition(this.hostConfig) : this.internalPadding.toSpacingDefinition(this.hostConfig);\n    this.renderedElement.style.paddingTop = effectivePadding.top + \"px\";\n    this.renderedElement.style.paddingRight = effectivePadding.right + \"px\";\n    this.renderedElement.style.paddingBottom = effectivePadding.bottom + \"px\";\n    this.renderedElement.style.paddingLeft = effectivePadding.left + \"px\";\n\n    if (this.isLastElementBleeding()) {\n      this.renderedElement.style.paddingBottom = \"0px\";\n    }\n  };\n\n  AdaptiveCard.prototype.internalRender = function () {\n    var renderedElement = _super.prototype.internalRender.call(this);\n\n    if (AdaptiveCard.useAdvancedCardBottomTruncation) {\n      // Unlike containers, the root card element should be allowed to\n      // be shorter than its content (otherwise the overflow truncation\n      // logic would never get triggered)\n      renderedElement.style.minHeight = null;\n    }\n\n    return renderedElement;\n  };\n\n  Object.defineProperty(AdaptiveCard.prototype, \"bypassVersionCheck\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AdaptiveCard.prototype, \"defaultPadding\", {\n    get: function () {\n      return new PaddingDefinition(Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding, Enums.Spacing.Padding);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AdaptiveCard.prototype, \"allowCustomPadding\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AdaptiveCard.prototype, \"allowCustomStyle\", {\n    get: function () {\n      return this.hostConfig.adaptiveCard && this.hostConfig.adaptiveCard.allowCustomStyle;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AdaptiveCard.prototype, \"hasBackground\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  AdaptiveCard.prototype.getJsonTypeName = function () {\n    return \"AdaptiveCard\";\n  };\n\n  AdaptiveCard.prototype.toJSON = function () {\n    var result = _super.prototype.toJSON.call(this);\n\n    Utils.setProperty(result, \"$schema\", \"http://adaptivecards.io/schemas/adaptive-card.json\");\n\n    if (!this.bypassVersionCheck && this.version) {\n      Utils.setProperty(result, \"version\", this.version.toString());\n    }\n\n    Utils.setProperty(result, \"fallbackText\", this.fallbackText);\n    Utils.setProperty(result, \"lang\", this.lang);\n    Utils.setProperty(result, \"speak\", this.speak);\n    return result;\n  };\n\n  AdaptiveCard.prototype.validate = function () {\n    var result = [];\n\n    if (this._cardTypeName != \"AdaptiveCard\") {\n      result.push({\n        error: Enums.ValidationError.MissingCardType,\n        message: \"Invalid or missing card type. Make sure the card's type property is set to \\\"AdaptiveCard\\\".\"\n      });\n    }\n\n    if (!this.bypassVersionCheck && !this.version) {\n      result.push({\n        error: Enums.ValidationError.PropertyCantBeNull,\n        message: \"The version property must be specified.\"\n      });\n    } else if (!this.isVersionSupported()) {\n      result.push({\n        error: Enums.ValidationError.UnsupportedCardVersion,\n        message: \"The specified card version (\" + this.version + \") is not supported. The maximum supported card version is \" + AdaptiveCard.currentVersion\n      });\n    }\n\n    return result.concat(_super.prototype.validate.call(this));\n  };\n\n  AdaptiveCard.prototype.parse = function (json, errors) {\n    this._fallbackCard = null;\n    this._cardTypeName = json[\"type\"];\n    var langId = json[\"lang\"];\n\n    if (langId && typeof langId === \"string\") {\n      try {\n        this.lang = langId;\n      } catch (e) {\n        raiseParseError({\n          error: Enums.ValidationError.InvalidPropertyValue,\n          message: e.message\n        }, errors);\n      }\n    }\n\n    this.version = HostConfig.Version.parse(json[\"version\"], errors);\n    this.fallbackText = json[\"fallbackText\"];\n    var fallbackElement = createElementInstance(null, json[\"fallback\"], errors);\n\n    if (fallbackElement) {\n      this._fallbackCard = new AdaptiveCard();\n\n      this._fallbackCard.addItem(fallbackElement);\n    }\n\n    _super.prototype.parse.call(this, json, errors);\n  };\n\n  AdaptiveCard.prototype.render = function (target) {\n    var fallback = false;\n    var renderedCard;\n\n    if (this.shouldFallback()) {\n      if (this._fallbackCard) {\n        this._fallbackCard.hostConfig = this.hostConfig;\n        renderedCard = this._fallbackCard.render();\n      } else {\n        var errorText = !Utils.isNullOrEmpty(this.fallbackText) ? this.fallbackText : \"The card could not be rendered. It is either malformed or uses features not supported by this host.\";\n\n        try {\n          var fallbackCard = new AdaptiveCard();\n          fallbackCard.hostConfig = this.hostConfig;\n          fallbackCard.parse({\n            type: \"AdaptiveCard\",\n            version: \"1.0\",\n            body: [{\n              type: \"TextBlock\",\n              text: errorText,\n              wrap: true\n            }]\n          });\n          renderedCard = fallbackCard.render();\n        } catch (e) {\n          renderedCard = document.createElement(\"div\");\n          renderedCard.innerHTML = errorText;\n        }\n      }\n    } else {\n      renderedCard = _super.prototype.render.call(this);\n\n      if (renderedCard) {\n        renderedCard.tabIndex = 0;\n\n        if (!Utils.isNullOrEmpty(this.speak)) {\n          renderedCard.setAttribute(\"aria-label\", this.speak);\n        }\n      }\n    }\n\n    if (target) {\n      target.appendChild(renderedCard);\n      this.updateLayout();\n    }\n\n    return renderedCard;\n  };\n\n  AdaptiveCard.prototype.updateLayout = function (processChildren) {\n    if (processChildren === void 0) {\n      processChildren = true;\n    }\n\n    _super.prototype.updateLayout.call(this, processChildren);\n\n    if (AdaptiveCard.useAdvancedCardBottomTruncation && this.isRendered()) {\n      var card = this.renderedElement;\n      var padding = this.hostConfig.getEffectiveSpacing(Enums.Spacing.Default);\n      this['handleOverflow'](card.offsetHeight - padding);\n    }\n  };\n\n  AdaptiveCard.prototype.canContentBleed = function () {\n    return true;\n  };\n\n  AdaptiveCard.prototype.shouldFallback = function () {\n    return _super.prototype.shouldFallback.call(this) || !this.isVersionSupported();\n  };\n\n  Object.defineProperty(AdaptiveCard.prototype, \"hasVisibleSeparator\", {\n    get: function () {\n      return false;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  AdaptiveCard.currentVersion = new HostConfig.Version(1, 1);\n  AdaptiveCard.useAutomaticContainerBleeding = false;\n  AdaptiveCard.useAdvancedTextBlockTruncation = true;\n  AdaptiveCard.useAdvancedCardBottomTruncation = false;\n  AdaptiveCard.useMarkdownInRadioButtonAndCheckbox = true;\n  AdaptiveCard.allowMarkForTextHighlighting = false;\n  AdaptiveCard.elementTypeRegistry = new ElementTypeRegistry();\n  AdaptiveCard.actionTypeRegistry = new ActionTypeRegistry();\n  AdaptiveCard.onAnchorClicked = null;\n  AdaptiveCard.onExecuteAction = null;\n  AdaptiveCard.onElementVisibilityChanged = null;\n  AdaptiveCard.onImageLoaded = null;\n  AdaptiveCard.onInlineCardExpanded = null;\n  AdaptiveCard.onParseElement = null;\n  AdaptiveCard.onParseAction = null;\n  AdaptiveCard.onParseError = null;\n  AdaptiveCard.onProcessMarkdown = null;\n  return AdaptiveCard;\n}(ContainerWithActions);\n\nexports.AdaptiveCard = AdaptiveCard;\n\nvar InlineAdaptiveCard =\n/** @class */\nfunction (_super) {\n  __extends(InlineAdaptiveCard, _super);\n\n  function InlineAdaptiveCard() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.suppressStyle = false;\n    return _this;\n  }\n\n  Object.defineProperty(InlineAdaptiveCard.prototype, \"bypassVersionCheck\", {\n    get: function () {\n      return true;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(InlineAdaptiveCard.prototype, \"defaultPadding\", {\n    get: function () {\n      return new PaddingDefinition(this.suppressStyle ? Enums.Spacing.None : Enums.Spacing.Padding, Enums.Spacing.Padding, this.suppressStyle ? Enums.Spacing.None : Enums.Spacing.Padding, Enums.Spacing.Padding);\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(InlineAdaptiveCard.prototype, \"defaultStyle\", {\n    get: function () {\n      if (this.suppressStyle) {\n        return Enums.ContainerStyle.Default;\n      } else {\n        return this.hostConfig.actions.showCard.style ? this.hostConfig.actions.showCard.style : Enums.ContainerStyle.Emphasis;\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  InlineAdaptiveCard.prototype.render = function (target) {\n    var renderedCard = _super.prototype.render.call(this, target);\n\n    renderedCard.setAttribute(\"aria-live\", \"polite\");\n    renderedCard.removeAttribute(\"tabindex\");\n    return renderedCard;\n  };\n\n  InlineAdaptiveCard.prototype.getForbiddenActionTypes = function () {\n    return [ShowCardAction];\n  };\n\n  return InlineAdaptiveCard;\n}(AdaptiveCard);\n\nvar defaultHostConfig = new HostConfig.HostConfig({\n  supportsInteractivity: true,\n  fontFamily: \"Segoe UI\",\n  spacing: {\n    small: 10,\n    default: 20,\n    medium: 30,\n    large: 40,\n    extraLarge: 50,\n    padding: 20\n  },\n  separator: {\n    lineThickness: 1,\n    lineColor: \"#EEEEEE\"\n  },\n  fontSizes: {\n    small: 12,\n    default: 14,\n    medium: 17,\n    large: 21,\n    extraLarge: 26\n  },\n  fontWeights: {\n    lighter: 200,\n    default: 400,\n    bolder: 600\n  },\n  imageSizes: {\n    small: 40,\n    medium: 80,\n    large: 160\n  },\n  containerStyles: {\n    default: {\n      backgroundColor: \"#FFFFFF\",\n      foregroundColors: {\n        default: {\n          default: \"#333333\",\n          subtle: \"#EE333333\"\n        },\n        dark: {\n          default: \"#000000\",\n          subtle: \"#66000000\"\n        },\n        light: {\n          default: \"#FFFFFF\",\n          subtle: \"#33000000\"\n        },\n        accent: {\n          default: \"#2E89FC\",\n          subtle: \"#882E89FC\"\n        },\n        attention: {\n          default: \"#cc3300\",\n          subtle: \"#DDcc3300\"\n        },\n        good: {\n          default: \"#54a254\",\n          subtle: \"#DD54a254\"\n        },\n        warning: {\n          default: \"#e69500\",\n          subtle: \"#DDe69500\"\n        }\n      }\n    },\n    emphasis: {\n      backgroundColor: \"#08000000\",\n      foregroundColors: {\n        default: {\n          default: \"#333333\",\n          subtle: \"#EE333333\"\n        },\n        dark: {\n          default: \"#000000\",\n          subtle: \"#66000000\"\n        },\n        light: {\n          default: \"#FFFFFF\",\n          subtle: \"#33000000\"\n        },\n        accent: {\n          default: \"#2E89FC\",\n          subtle: \"#882E89FC\"\n        },\n        attention: {\n          default: \"#cc3300\",\n          subtle: \"#DDcc3300\"\n        },\n        good: {\n          default: \"#54a254\",\n          subtle: \"#DD54a254\"\n        },\n        warning: {\n          default: \"#e69500\",\n          subtle: \"#DDe69500\"\n        }\n      }\n    }\n  },\n  actions: {\n    maxActions: 5,\n    spacing: Enums.Spacing.Default,\n    buttonSpacing: 10,\n    showCard: {\n      actionMode: Enums.ShowCardActionMode.Inline,\n      inlineTopMargin: 16\n    },\n    actionsOrientation: Enums.Orientation.Horizontal,\n    actionAlignment: Enums.ActionAlignment.Left\n  },\n  adaptiveCard: {\n    allowCustomStyle: false\n  },\n  imageSet: {\n    imageSize: Enums.Size.Medium,\n    maxImageHeight: 100\n  },\n  factSet: {\n    title: {\n      color: Enums.TextColor.Default,\n      size: Enums.TextSize.Default,\n      isSubtle: false,\n      weight: Enums.TextWeight.Bolder,\n      wrap: true,\n      maxWidth: 150\n    },\n    value: {\n      color: Enums.TextColor.Default,\n      size: Enums.TextSize.Default,\n      isSubtle: false,\n      weight: Enums.TextWeight.Default,\n      wrap: true\n    },\n    spacing: 10\n  }\n});","map":null,"metadata":{},"sourceType":"script"}