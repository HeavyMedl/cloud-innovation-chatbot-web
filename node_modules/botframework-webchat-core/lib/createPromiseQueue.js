"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _default;

var _createDeferred = _interopRequireDefault(require("./createDeferred"));

function _default() {
  var deferred;
  var queue = [];

  var push = function push(value) {
    if (deferred) {
      var _deferred = deferred,
          resolve = _deferred.resolve;
      deferred = null;
      resolve(value);
    } else {
      queue.push(value);
    }
  };

  var shift = function shift() {
    if (queue.length) {
      return Promise.resolve(queue.shift());
    } else {
      return (deferred || (deferred = (0, _createDeferred["default"])())).promise;
    }
  };

  return {
    push: push,
    shift: shift
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jcmVhdGVQcm9taXNlUXVldWUuanMiXSwibmFtZXMiOlsiZGVmZXJyZWQiLCJxdWV1ZSIsInB1c2giLCJ2YWx1ZSIsInJlc29sdmUiLCJzaGlmdCIsImxlbmd0aCIsIlByb21pc2UiLCJwcm9taXNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFFZSxvQkFBWTtBQUN6QixNQUFJQSxRQUFKO0FBQ0EsTUFBTUMsS0FBSyxHQUFHLEVBQWQ7O0FBRUEsTUFBTUMsSUFBSSxHQUFHLFNBQVBBLElBQU8sQ0FBQUMsS0FBSyxFQUFJO0FBQ3BCLFFBQUlILFFBQUosRUFBYztBQUFBLHNCQUNRQSxRQURSO0FBQUEsVUFDSkksT0FESSxhQUNKQSxPQURJO0FBR1pKLE1BQUFBLFFBQVEsR0FBRyxJQUFYO0FBQ0FJLE1BQUFBLE9BQU8sQ0FBQ0QsS0FBRCxDQUFQO0FBQ0QsS0FMRCxNQUtPO0FBQ0xGLE1BQUFBLEtBQUssQ0FBQ0MsSUFBTixDQUFXQyxLQUFYO0FBQ0Q7QUFDRixHQVREOztBQVdBLE1BQU1FLEtBQUssR0FBRyxTQUFSQSxLQUFRLEdBQU07QUFDbEIsUUFBSUosS0FBSyxDQUFDSyxNQUFWLEVBQWtCO0FBQ2hCLGFBQU9DLE9BQU8sQ0FBQ0gsT0FBUixDQUFnQkgsS0FBSyxDQUFDSSxLQUFOLEVBQWhCLENBQVA7QUFDRCxLQUZELE1BRU87QUFDTCxhQUFPLENBQUNMLFFBQVEsS0FBS0EsUUFBUSxHQUFHLGlDQUFoQixDQUFULEVBQTRDUSxPQUFuRDtBQUNEO0FBQ0YsR0FORDs7QUFRQSxTQUFPO0FBQ0xOLElBQUFBLElBQUksRUFBSkEsSUFESztBQUVMRyxJQUFBQSxLQUFLLEVBQUxBO0FBRkssR0FBUDtBQUlEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZURlZmVycmVkIGZyb20gJy4vY3JlYXRlRGVmZXJyZWQnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoKSB7XG4gIGxldCBkZWZlcnJlZDtcbiAgY29uc3QgcXVldWUgPSBbXTtcblxuICBjb25zdCBwdXNoID0gdmFsdWUgPT4ge1xuICAgIGlmIChkZWZlcnJlZCkge1xuICAgICAgY29uc3QgeyByZXNvbHZlIH0gPSBkZWZlcnJlZDtcblxuICAgICAgZGVmZXJyZWQgPSBudWxsO1xuICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHF1ZXVlLnB1c2godmFsdWUpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBzaGlmdCA9ICgpID0+IHtcbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHF1ZXVlLnNoaWZ0KCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKGRlZmVycmVkIHx8IChkZWZlcnJlZCA9IGNyZWF0ZURlZmVycmVkKCkpKS5wcm9taXNlO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHB1c2gsXG4gICAgc2hpZnRcbiAgfVxufVxuIl19